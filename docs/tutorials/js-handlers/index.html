<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/shinytutorials/styles.d51cc9df64f8c757351f.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2b2b2b}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#d4d0ab}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{color:windowText;background:window}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}@font-face{font-family:Open Sans;font-style:normal;font-weight:400;src:url(/shinytutorials/static/open-sans-v17-latin-regular-5f4d4bc11d64b6cb605b7030c1997270.eot);src:local("Open Sans Regular"),local("OpenSans-Regular"),url(/shinytutorials/static/open-sans-v17-latin-regular-5f4d4bc11d64b6cb605b7030c1997270.eot?#iefix) format("embedded-opentype"),url(/shinytutorials/static/open-sans-v17-latin-regular-33543c5cc5d88f5695dd08c87d280dfd.woff2) format("woff2"),url(/shinytutorials/static/open-sans-v17-latin-regular-de0869e324680c99efa1250515b4b41c.woff) format("woff"),url(/shinytutorials/static/open-sans-v17-latin-regular-049a929c5d81988b3ae6d2f985ca7aa5.ttf) format("truetype"),url(/shinytutorials/static/open-sans-v17-latin-regular-7aab4c13671282c90669eb6a10357e41.svg#OpenSans) format("svg")}@font-face{font-family:Open Sans;font-style:normal;font-weight:600;src:url(/shinytutorials/static/open-sans-v17-latin-600-ddacaf4a9db58cda27c76ce88c408546.eot);src:local("Open Sans SemiBold"),local("OpenSans-SemiBold"),url(/shinytutorials/static/open-sans-v17-latin-600-ddacaf4a9db58cda27c76ce88c408546.eot?#iefix) format("embedded-opentype"),url(/shinytutorials/static/open-sans-v17-latin-600-819af3d3abdc9f135d49b80a91e2ff4c.woff2) format("woff2"),url(/shinytutorials/static/open-sans-v17-latin-600-449d681cd6006390e1bee3c3a660430b.woff) format("woff"),url(/shinytutorials/static/open-sans-v17-latin-600-8f7128145a3c2b83923552a328df7cdc.ttf) format("truetype"),url(/shinytutorials/static/open-sans-v17-latin-600-e16f375be3c2a73b58255a02f6d3a9ce.svg#OpenSans) format("svg")}body,html{padding:0;margin:0;font-family:Open Sans,Helvetica,sans-serif;cursor:default;font-size:15pt}article,aside,footer,header,main,nav{padding:0;margin:0;display:block}h1,h2,h3,h4,h5,h6{display:block;color:#2a2c32;line-height:1.3;padding:0;margin:0 0 6px}p{color:#3f454b;line-height:1.6;padding:0;margin:0 0 12px}ol li,ul li{margin:0;padding:0;line-height:1.7}ol li p,ul li p{padding:0;margin:0;line-height:1}ol li a,ul li a{padding:0;margin:0;line-height:1.5}li{color:#3f454b;line-height:1.3}a{color:#5177b8;text-decoration:none;box-shadow:0 1px 0 #5177b8}blockquote{line-height:1.3}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:90%;font-size:12pt;padding:8px 8px 8px 12px;border-radius:0;border:none;background-color:#f6f6f6;box-shadow:inset 0 2px 2px #d8d8d8}img,input{display:block}img{width:100%}:not(pre)>code{font-size:14pt}.icon{display:inline-block;width:20px;height:20px}.gatsby-highlight{font-size:12pt;overflow:auto}.gatsby-highlight pre{border-radius:4px}.gatsby-resp-image-link{box-shadow:none}button{display:block;border:none;background:none;cursor:pointer}.btn,.btn-link{display:block;padding:4px;margin:8px 0;font-size:14px;background-color:transparent;border-left:3px solid transparent;text-align:center}.btn-primary,.btn-secondary{text-transform:uppercase;letter-spacing:2px;font-weight:600;border-radius:3px;padding:6px 12px}.btn-primary{background-color:#5177b8;border:2px solid #5177b8;color:#fff;padding:8px 12px}.btn-primary:focus,.btn-primary:hover{background-color:transparent;border-color:#5177b8;color:#5177b8}.btn-secondary{background-color:transparent;border:2px solid #5177b8;color:#5177b8}.btn-secondary:focus,.btn-secondary:hover{background-color:#5177b8;color:#f6f6f6;border-color:#5177b8}.btn-keyword{font-size:12pt}.btn-keyword.selected,.btn-keyword:focus,.btn-keyword:hover{color:#5177b8;font-weight:600;border-left-color:#5177b8}.btn-centered{width:100px;margin:24px auto 0}.nav{position:fixed;top:0;left:0;width:100%;padding:6px 0;display:-ms-grid;display:grid;grid-template-columns:65% 35%;grid-template-areas:"brandLink menuBtn";-webkit-column-gap:0;column-gap:0;row-gap:0;background-color:#fff;box-shadow:0 2px 6px rgba(0,0,0,.18);z-index:15}.nav .nav-item{display:flex;align-items:center}.nav .nav-item.brand-link{grid-area:brandLink;color:#5177b8;font-weight:600;font-size:14pt;letter-spacing:2px;padding:0 0 0 16px;box-shadow:none}.nav .nav-item.brand-link .brand-link-icon path{fill:#5177b8}.nav .navigation{display:block;position:absolute;top:48px;width:1px;height:1px;clip:rect(0 0 0 0);clip:rect(0,0,0,0);padding:32px 0;background-color:#fff;z-index:14}.nav .navigation .menu-item{display:block;text-align:center}.nav .navigation .menu-item .menu-link{font-size:16pt;box-shadow:none}.nav .navigation.expanded{width:100%;height:auto;clip:auto;box-shadow:0 6px 6px rgba(0,0,0,.18)}.nav .menu-btns{justify-content:flex-end;grid-area:menuBtn}.nav .menu-btns .menu-button{margin:0}.nav .menu-btns .menu-button #menuBtn{margin-right:16px}@media screen and (min-width:972px){.nav{display:grid;grid-template-areas:"brandLink navLinks";grid-template-columns:200px 80%}.nav .nav-item.brand-link{padding-bottom:0;grid-area:brandLink}.nav .nav-item.navigation{position:static;display:flex;width:100%;grid-area:navLinks;box-shadow:none}.nav .nav-item.navigation .menu-item{display:inline-block;width:auto;margin:0 24px 0 0}.nav .nav-item.navigation .menu-item .menu-link{font-size:11pt}.nav .nav-item.navigation .menu-item:last-child{margin-right:0}.nav .nav-item.menu-btns{display:none}}.menu{width:100%;margin:0 auto;list-style:none;padding:6px 0}.menu .menu-item{display:block;padding:0;margin:0 0 12px}.menu .menu-item .menu-link{position:relative;text-transform:uppercase;font-size:11pt;letter-spacing:2px;font-weight:600;color:#5177b8;padding-bottom:4px;border-bottom:2px solid transparent}.menu .menu-item .menu-link .menu-link-icon{position:relative;padding-right:6px;top:4px}.menu .menu-item .menu-link .menu-link-icon path{fill:#5177b8}.menu .menu-item .menu-link:hover{border-bottom-color:#5177b8}@media screen and (min-width:972px){.menu .menu-item{display:inline-block;margin:0 18px 0 0}}.footer{margin:0;padding:62px 0;background-color:#2a2c32}.footer h2{display:block;width:85%;margin:0 auto;padding-top:12px;color:#d8d8d8;letter-spacing:2.5px}.footer .menu{list-style:none;width:85%;margin:12px auto;padding:0}.footer .menu .menu-item{margin-right:24px}.footer .menu .menu-item .menu-link{color:#d8d8d8;box-shadow:none}.footer .menu .menu-item .menu-link .menu-link-icon path{fill:#d8d8d8}.footer .menu .menu-item .menu-link:hover{border-bottom-color:#d8d8d8}.post{padding:32px;border-radius:6px}.post .post-image{background-position:50%;background-size:cover;margin-bottom:12px}.post .post-title{margin:0;padding:0}.post .post-title-link a{color:#2a2c32;box-shadow:0 1px 0 #3f454b}.post .post-desc{padding:0;margin:0;width:100%}.post .post-date{display:inline-block;color:#3f454b;font-size:11pt;font-family:consolas,courier,sans-serif;margin-right:12px}.post .post-tags{display:block;padding:0;margin:0 0 16px;list-style:none;color:#3f454b}.post .post-tags li{display:inline-block;margin-right:12px}.post .post-tags li .tag{border-radius:6px;font-size:11pt;padding:5px 10px;background-color:#f6f6f6;font-family:consolas,courier,sans-serif}.post .post-tags li .tag:before{content:"#"}.post .post-tags li:first-child{margin-left:0}.post .post-link{display:block;text-align:center;text-transform:uppercase;font-size:12pt;letter-spacing:2px;text-decoration:none;border-radius:4px;padding:6px 0;font-weight:600;box-shadow:none}.post .post-link:hover{text-decoration:underline}.post.post-feature{margin:16px auto;background-color:#fff}.post.post-feature .post-link{margin:0 auto;border:1px solid #5177b8;background-color:#5177b8;color:#fff}.post.post-plain{background-color:#fff;margin-bottom:16px}.post.post-plain .post-link{border:1px solid #5177b8}.post.post-plain .post-link:hover{background-color:#5177b8;color:#fff}.post-form{padding:32px;border-radius:0 0 6px;background-color:#fff;border-top:4px solid #5177b8;margin-bottom:16px}.post-form .input-label{display:block;padding:0;margin:0;font-size:18pt;color:#3f454b;font-weight:600}.post-form .input-example{line-height:1.5;padding:0;font-size:12pt;color:#3f454b;margin:0 0 12px}@media screen and (min-width:972px){.post{max-width:872px}.post.post-plain .post-link,.post.post-plain .post-tags{display:inline-flex;justify-content:center;align-items:center}.post.post-plain .post-link{width:125px;float:right}.post-form{max-width:872px}}.hero{width:100%;padding:44px 0;display:flex;position:relative;justify-content:center;align-items:center;background-color:#fff;overflow:hidden}.hero.hero-index .hero-content{width:90%;margin:0 auto;padding:72px 0;z-index:2}.hero.hero-index .hero-content .hero-title{font-size:21pt;letter-spacing:2.5px}.hero.hero-index .hero-content .hero-subtitle{font-weight:600;font-size:32pt;letter-spacing:2px;line-height:1.2}.hero.hero-index .hero-content .hero-image{display:block;width:300px;margin:44px auto;box-shadow:0 12px 3px -6px rgba(0,0,0,.18)}.hero.hero-text .hero-content{width:90%;margin:0 auto;padding:82px 0 0}.hero.hero-text .hero-content p{margin:0}.hero.hero-style-1{background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIxNDQwcHgiIGhlaWdodD0iNjcxcHgiIHZpZXdCb3g9IjAgMCAxNDQwIDY3MSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48IS0tR2VuZXJhdG9yOiBTa2V0Y2ggNTkuMSAoODYxNDQpIC0gaHR0cHM6Ly9za2V0Y2guY29tLS0+PHRpdGxlPmhlcm8tYmstZ3JheTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9IkJhY2tncm91bmRzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBpZD0iaGVyby1iay1ncmF5LWNvcHkiIGZpbGw9IiM1MTc3YjgiIGZpbGwtb3BhY2l0eT0iMC4zIj48cGF0aCBkPSJNLTEuMjk5NjU0ODNlLTE0LDAgTDE0NDAsMCBDMTQ0MCw5NS45MTQ2OTE5IDE0NDAsMTg1Ljk3MzIwOCAxNDQwLDI3MC4xNzU1NDcgQzE0NDAsMzU0LjM3Nzg4NyAxNDQwLDQ3OS4zMTkzNzEgMTQ0MCw2NDUgQzEyODYuMzEwNjIsNTg3Ljc4MzUyNiAxMTI0LjkxNjc3LDU1MS45MDgyNTQgOTU1LjgxODQ0NSw1MzcuMzc0MTgzIEM3MDIuMTcwOTU5LDUxNS41NzMwNzYgNDU2Ljc1MDAwNiw3NDYuNzg4NDcxIDIxNi4yNzE0MTEsNjQ1IEM3MS41NDI5NDAxLDU4My43NDAxMjEgMC45MjI0ODU1MDIsNTA2LjI2ODcxIDEuMDM5NTg1MDhlLTEzLDQxMS42MzcxNzIgQy0wLjA2NjI0ODYzNzQsNDA0Ljg0MTE3MyAtMC4wNjYyNDg2Mzc0LDM5NC4yOTU0NDkgLTEuNTgxMzczOTJlLTE0LDM4MCBMLTEuMjk5NjU0ODNlLTE0LDAgWiIgaWQ9Imhlcm8tYmstZ3JheSIvPjwvZz48L2c+PC9zdmc+);background-size:cover;background-position:50% 100%;background-repeat:no-repeat}@media screen and (min-width:972px){.hero.hero-index .hero-content,.hero.hero-text .hero-content{width:100%;max-width:912px}.hero.hero-index .hero-content .hero-image,.hero.hero-text .hero-content .hero-image{transform:scale(1.25)}}.flex{display:flex}.flex .flex-child{display:block;width:100%;height:auto}.flex.flex-30x70-layout,.flex.flex-33x3-layout,.flex.flex-50x2-layout{width:100%;flex-wrap:wrap}@media (min-width:812px){.flex.flex-30x70-layout .flex-child{display:inline-block}.flex.flex-30x70-layout .flex-child:nth-child(odd){width:30%}.flex.flex-30x70-layout .flex-child:nth-child(2n){width:70%}.flex.flex-33x3-layout .flex-child{display:inline-block;width:33%}.flex.flex-50x2-layout .flex-child{display:inline-block}.flex.flex-50x2-layout .flex-child:nth-child(2n),.flex.flex-50x2-layout .flex-child:nth-child(odd){width:50%}}.article-profile{display:inline-flex;justify-content:center;align-items:center;margin-top:12px}.article-profile .profile-img{width:40px;border-radius:50%}.article-profile .profile-name{font-size:12pt;margin-left:6px;color:#3f454b}.article-hero{padding-bottom:0}.article-hero h1{font-size:13pt;text-transform:uppercase;letter-spacing:2px}.article-hero h2{font-size:28pt}.article-hero .article-dates,.article-hero .article-readtime{margin:0;line-height:1.5;font-size:11pt;text-transform:uppercase;letter-spacing:2px;padding:0}.article-hero .article-dates time,.article-hero .article-readtime time{font-weight:400}.article-hero .article-readtime{color:#5177b8}.article{width:100%;padding:32px 0;border-radius:6px;background-color:#fff}.article .article-abstract,.article .article-body,.article .article-footer,.article .article-title{display:block;width:90%;margin:0 auto}.article .article-title{text-align:center}.article .article-abstract{color:#3f454b;line-height:1.6}.article .article-abstract :not(h2){color:#3f454b}.article .article-body h2{padding:0;margin:24px 0 0}.article .article-body a{color:#5177b8}.article .article-body blockquote{background-color:#f6f6f6;padding:2px 12px;margin:44px 0;border-left:10px solid #5177b8}.article .article-footer{border-top:1px solid #a3a6a8;margin-top:12px;padding-top:12px}.article .article-footer .article-tags{display:inline-block;padding:0;margin:0;list-style:none;color:#3f454b}.article .article-footer .article-tags li{display:inline-block;margin-right:12px}.article .article-footer .article-tags li .tag{border-radius:6px;font-size:11pt;padding:5px 10px;background-color:#f6f6f6;font-family:consolas,courier,sans-serif}.article .article-footer .article-tags li .tag:before{content:"#"}.article .article-footer .article-tags li:first-child{margin-left:0}.article-toc h2{font-size:21pt}.article-toc ol{font-size:13pt}.article-toc ol li{margin-bottom:12px}.article-toc ol li ol{margin-top:12px;list-style:upper-alpha}.article-toc ol li ol li{margin-bottom:6px}.article-toc ol li ol li ol{list-style:lower-roman}.article-toc ol li:last-child,.article-toc ol li ol li:last-child{margin-bottom:0}.article-toc ol a{box-shadow:none}.article-toc ol a :focus,.article-toc ol a:hover{box-shadow:0 2px 0 0 #5177b8}@media (min-width:972px){.article{max-width:812px}}.main{padding:0;min-height:60vh}.main .full-section{width:100%}.main .full-section .full-section-content,.main .main-section{width:90%;margin:0 auto}.main .main-section{padding:24px 0}.main .filled-section{padding:44px 0}.main .filled-section:not(.welcome-section){background-color:#f6f6f6}.main .filled-section:not(.welcome-section) p:not(.post-desc){text-align:center}.main .filled-section h2{text-align:center;text-transform:uppercase;letter-spacing:2px;padding:0;margin:0}.main .filled-section:last-child{margin-bottom:0}.main .filled-section.welcome-section p{max-width:812px;margin:0 auto}@media (min-width:972px){.main .full-section .full-section-content,.main .main-section{max-width:972px}}.sidebar-layout{display:flex;width:100%;flex-wrap:wrap}.sidebar-layout .sidebar-panel{position:static;padding-top:50px}.sidebar-layout .sidebar-panel .sidebar-content{background-color:#fff;margin:0 auto;padding:32px;border-radius:6px}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title{display:block;width:100%}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle{position:relative;margin:0;padding:0;font-size:18pt}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon{position:absolute;top:4px;margin-left:12px;transform:rotate(-45deg);transform-origin:center center;transition:all .3s ease-in-out}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon circle{fill:#f6f6f6}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon line{stroke:#5177b8}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon.rotated{transform:rotate(0)}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-caption{margin:0 0 12px;line-height:1.3;font-size:14pt}.sidebar-layout .sidebar-panel .sidebar-content .taglist{list-style:none;padding:0;margin:0 0 16px -6px}.sidebar-layout .sidebar-panel .sidebar-content .taglist .taglist-item{width:200px;padding:0 24px 0 0;margin-bottom:12px;cursor:pointer}.sidebar-layout .sidebar-panel .sidebar-content.expanded{position:absolute;width:1px;height:1px;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);overflow:hidden}.sidebar-layout .main-panel{padding-top:50px}.sidebar-layout .main-panel,.sidebar-layout .sidebar-panel{width:90%;margin:0 auto}@media (min-width:972px){.sidebar-layout .sidebar-panel{width:30%;margin:0 auto;position:-webkit-sticky;position:sticky;top:62px;height:100%}.sidebar-layout .main-panel,.sidebar-layout .sidebar-panel .sidebar-content{width:70%}}#menuBtn{display:flex;justify-content:center;align-items:center;background-color:transparent}#menuBtn .menu-icon{display:block;margin:0 auto;position:relative}#menuBtn .menu-icon .menu-bar{display:block;height:3px;width:30px;border-radius:6px;margin-bottom:6px;background-color:#5177b8;transition:all .2s ease-in-out}#menuBtn .menu-icon .menu-bar:first-child{margin-top:2px}#menuBtn.open .menu-bar:first-child{opacity:0}#menuBtn.open .menu-bar:nth-child(2){transform:rotate(-45deg);transform-origin:center .5px;background-color:#5177b8}#menuBtn.open .menu-bar:nth-child(3){transform:rotate(45deg);transform-origin:24.85px -2.5px;background-color:#5177b8}#menuBtn.open .menu-label{color:#5177b8}.article table,.datatable{width:100%;margin:8px auto 6px;font-weight:400;border-spacing:0;text-align:left;font-size:13pt}.article table caption,.datatable caption{text-align:left;font-size:16pt;margin:12px 0;color:#2a2c32;font-weight:600}.article table thead tr th,.datatable thead tr th{font-weight:600;padding:4px 12px;border-bottom:1px solid #2a2c32;color:#2a2c32}.article table tbody tr td,.datatable tbody tr td{padding:24px 12px}.article table tbody tr td .hidden-colname,.datatable tbody tr td .hidden-colname{display:none}.article table tbody tr:nth-child(2n),.datatable tbody tr:nth-child(2n){background-color:#f6f6f6}@media (max-width:892px){.datatable thead{display:none}.datatable tbody tr{display:block;margin-bottom:16px;counter-increment:rowCounter}.datatable tbody tr:nth-child(2n){background-color:transparent}.datatable tbody tr td{display:block;padding:6px 0 6px 6px;color:#3f454b}.datatable tbody tr td:first-child{font-size:16pt;color:#2a2c32}.datatable tbody tr td:first-child:before{content:counter(rowCounter) ".";display:inline-block;margin-right:4px;font-size:15pt}.datatable tbody tr td:not(:first-child){border-bottom:1px solid #f6f6f6}.datatable tbody tr td .hidden-colname{display:inline-block;width:150px}.datatable tbody tr td .hidden-colname:after{content:":"}.datatable-container{display:block;width:100%;overflow-x:scroll}}.visually-hidden{position:absolute;width:1px;height:1px;clip:rect(0 0 0 0);clip:rect(0,0,0,0);overflow:hidden}.tutorial-index{padding:0 0 66px;background-color:#f6f6f6}.tutorial-index .tutorial-index-posts{padding:32px 0}.tutorial-index .tutorial-index-posts h2{padding-left:32px;margin-bottom:32px}.tutorial{padding:0 0 50px;background-color:#f6f6f6}.about-page #repos .column-4,.about-page #repos .column-5,.about-page #repos .column-6,.about-page #repos thead th:nth-child(n+4){text-align:left}@media (min-width:972px){.related-projects .post.post-feature,.tutorial-latest .post.post-feature{max-width:40%}.related-projects .post.post-feature:nth-child(odd),.tutorial-latest .post.post-feature:nth-child(odd){margin-right:32px}.tutorial-index .tutorial-index-posts{padding-top:82px}.about-page #repos .column-4,.about-page #repos .column-5,.about-page #repos .column-6,.about-page #repos thead th:nth-child(n+4){text-align:right}.gallery-page .post .post-link{width:250px}}</style><meta name="generator" content="Gatsby 2.20.10"/><title data-react-helmet="true">shinyTutorials | Getting started with JavaScript handlers</title><meta data-react-helmet="true" name="description" content="Getting started with JavaScript handlers Linking R and Javascript"/><meta data-react-helmet="true" property="og:title" content="Getting started with JavaScript handlers"/><meta data-react-helmet="true" property="og:description" content="Getting started with JavaScript handlers Linking R and Javascript"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="dcruvolo"/><meta data-react-helmet="true" name="twitter:title" content="Getting started with JavaScript handlers"/><meta data-react-helmet="true" name="twitter:description" content="Getting started with JavaScript handlers Linking R and Javascript"/><meta data-react-helmet="true" name="keywords" content="javascript"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="shinytutorials latest posts" href="/shinytutorials/rss.xml"/><link as="script" rel="preload" href="/shinytutorials/webpack-runtime-7f142a406dc5b8165a13.js"/><link as="script" rel="preload" href="/shinytutorials/framework-e94c62ba7ecbd1156bac.js"/><link as="script" rel="preload" href="/shinytutorials/app-861713a6e6d99061f672.js"/><link as="script" rel="preload" href="/shinytutorials/styles-36681512479a843831b0.js"/><link as="script" rel="preload" href="/shinytutorials/commons-c531f5118f02e9104877.js"/><link as="script" rel="preload" href="/shinytutorials/ec800322c0f71b5715d75b0073f476a066af1f45-5dfcbcfd5bde2ac1f549.js"/><link as="script" rel="preload" href="/shinytutorials/component---src-components-tutorials-js-d53ebef395d5c90dcd9c.js"/><link as="fetch" rel="preload" href="/shinytutorials/page-data/tutorials/js-handlers/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/shinytutorials/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="nav" role="navigation"><a class="nav-item brand-link" href="/shinytutorials/">shinyTutorials</a><ul class="menu nav-item navigation"></ul><ul class="nav-item menu menu-btns" aria-label="site settings"><li class="menu-item menu-button"><button id="menuBtn" class="" aria-expanded="false"><span class="menu-icon" aria-hidden="true"><span class="menu-bar"></span><span class="menu-bar"></span><span class="menu-bar"></span></span></button></li></ul></nav><header class="hero hero-index article-hero"><div class="hero-content"><h1 class="hero-title"></h1><h2 class="hero-subtitle"></h2><h1>Getting started with JavaScript handlers</h1><h2>Linking R and Javascript</h2><p class="article-dates">Published: <time>2019-09-06</time></p><p class="article-dates">Updated: <time>2019-10-25</time></p><p class="article-readtime"><time>18</time> minute read</p><div class="article-profile"><img class="profile-img" src="/shinytutorials/static/dcruvolo-16a2e1e5e48ba95aed1c754fd7fd0d57.jpeg" alt="@dcruvolo"/><span class="profile-name">@dcruvolo</span></div></div></header><main id="main" class="main tutorial" aria-label="main content"><div class="sidebar-layout"><aside class="sidebar-panel article-toc"><section class="sidebar-content"><div><h2>Contents</h2>
<ol>
<li><a href="#about">Why would I need this?</a></li>
<li>
<p><a href="#work">How does this app work?</a></p>
<ol>
<li><a href="#setup">Creating the files</a></li>
<li><a href="#ui">Defining the ui</a></li>
<li><a href="#server">Defining the server</a></li>
<li><a href="#js">Writing the javascript functions</a></li>
<li><a href="#registering">Registering the javascript functions</a></li>
<li><a href="#js-running">Running the js functions from the server</a></li>
</ol>
</li>
<li><a href="#know">What do I need to know before I intergrate this into my app?</a> </li>
<li><a href="#run">How do I run the demo?</a></li>
</ol>
</div></section></aside><div class="main-panel tutorial-body"><article class="article"><section class="article-abstract"><h2>Overview</h2>Learn how to add custom js functions for more interactivity in shiny apps. In this example, we will create a dark and light theme toggle and learn how to save the user preferences for later use.</section><section class="article-body">
<span id="about" />
<h2>Why would I need this?</h2>
<p>In this example, we will build a shiny app that toggles between a light and a dark theme. The purpose of this example is to demonstrate how to send information trigged by a event in the shiny ui and run it through custom javascript function via the shiny server. This approach is likely to be for you if you want to create your own input widgets (select inputs, radio buttons, etc.) and UIs, as well as enhancing the interactivity of your shiny app.</p>
<p>This approach isn't for all projects and situations. It does take a little bit longer to set up and debug. There are already a few packages that can handle this from the server (i.e., <a href="https://cran.r-project.org/web/packages/shinyjs/index.html">shinyJS</a>, <a href="https://cran.r-project.org/web/packages/shinyBS/index.html">shinyBS</a>). These packages are well maintained and there are a number of examples available. Personally, I prefer writing my own html and javascript. I have some html and js code that I've written for non-R projects that I wanted to integrate into my shiny apps. This approach is useful for projects that required a static site and a shiny app that needed to follow branding guidelines. If you like to writing javascript and building everything from scratch (like me), then you would like this approach.</p>
<span id="work" />
<h2>How does this app work?</h2>
<p>In this demo, we will build a shiny app that allows us to do three things.</p>
<ol>
<li>Toggle between a light and dark theme, and display the name of the current theme</li>
<li>Save the selected theme for later use</li>
<li>Load the last theme selected and set it as default when the app is started</li>
</ol>
<p>We will start off by building the UI, the server and followed by our javascript functions. Finally, we register our functions with shiny.</p>
<blockquote>
<p>This tutorial focuses on javascript. Some experience will definitely help, but not required. I've tried to keep concepts simple and reference outside sources where possible. If you have suggestions for improvement or notice any errors, feel free to open a new <a href="https://github.com/davidruvolo51/shinytutorials/issues">issue</a>.</p>
</blockquote>
<p>Let's get started.</p>
<span id="setup" />
<h3>Creating the files</h3>
<p>To make our code easier to manage, we will create a css file and a js file. The css file will have the styles associated with the themes and we will write all of our functions in the js file. Place these files in the <code>www/</code> folder. You can create individual folders for css files and js files if you like (as shown). We will also make our app.R file (you can also break up the file into server, ui, and global files).</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">- app.R
- www/
    css /
        styles.css
    js /
        index.js</code></pre></div>
<p>I won't cover the css for each theme. The only thing that you need to know is that there are two classes <code>.light-theme</code> and <code>.dark-theme</code>. Our js functions will add the class name to our UI and the browser will handle everything else.</p>
<span id="ui" />
<h3>Defining the UI</h3>
<p>I will be using the <code>tagList</code> method for building the UI. Our UI will have a few elements - a title, some text about what the app does, and a button that will be used to switch themes. We will also create a text element that will display the name of the current theme in the top right corner of the screen. Here are the elements we will use to make our layout.</p>
<ul>
<li><code>tags$head()</code>: we will define set the document's meta information for our page and load the css file. Meta information is used to describe a document which is read by the browser. There are many options available, but we will use some of the common ones. For more information, checkout <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/The_head_metadata_in_HTML">What's in the head?</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta">The Document-level Metadata element</a> articles by Mozilla.</li>
<li><code>tags$header()</code>: this element will contain a single element, which is the text that displays the current theme. We will use the <code>tags$output()</code> element for this. We will also give it an id which we can target with our javascript functions.</li>
<li><code>tags$main()</code>: this element is used for all main content in a document. Using the <code>&#x3C;main></code> element follows good semantic html and helpful for those using assitive web technologies (i.e., web accessibility). (See <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/main">main reference page</a> by Mozilla for more information). </li>
<li>
<p>Inside the <code>main</code> element, we will write all of our content in a <code>tags$section()</code>. Here's what we will write -</p>
<ul>
<li>A title for the app - <code>tags$h1()</code></li>
<li>Some text that describes the app and what to do - <code>tags$p()</code></li>
<li>A button used to toggle themes -  <code>tags$button()</code> (this will be a custom button too)</li>
</ul>
</li>
<li>Lastly, we will link our javascript file</li>
</ul>
<p>Here's what this all looks like put together.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">ui <span class="token operator">&lt;-</span> tagList<span class="token punctuation">(</span>

    <span class="token comment"># head</span>
    tags<span class="token operator">$</span>head<span class="token punctuation">(</span>

        <span class="token comment"># meta</span>
        tags<span class="token operator">$</span>meta<span class="token punctuation">(</span><span class="token string">"charset"</span> <span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        tags<span class="token operator">$</span>meta<span class="token punctuation">(</span><span class="token string">"http-equiv"</span> <span class="token operator">=</span><span class="token string">"X-UA-Compatible"</span><span class="token punctuation">,</span> <span class="token string">"content"</span> <span class="token operator">=</span><span class="token string">"IE=edge"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        tags<span class="token operator">$</span>meta<span class="token punctuation">(</span><span class="token string">"name"</span> <span class="token operator">=</span><span class="token string">"viewport"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment"># calling our css file</span>
        tags<span class="token operator">$</span>link<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">"text/css"</span><span class="token punctuation">,</span> rel<span class="token operator">=</span><span class="token string">"stylesheet"</span><span class="token punctuation">,</span> href<span class="token operator">=</span><span class="token string">"css/styles.css"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment"># define a title (to be display in the brower's window/tab)</span>
        tags<span class="token operator">$</span>title<span class="token punctuation">(</span><span class="token string">"Custom JS Handlers"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment"># header</span>
    tags<span class="token operator">$</span>header<span class="token punctuation">(</span>

        <span class="token comment"># output element that displays the name of the current theme</span>
        tags<span class="token operator">$</span>span<span class="token punctuation">(</span>class<span class="token operator">=</span><span class="token string">"theme-label"</span><span class="token punctuation">,</span> <span class="token string">"current theme:"</span><span class="token punctuation">,</span> tags<span class="token operator">$</span>output<span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token string">"themeStatus"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment"># main content - manually set &lt;main></span>
    tags<span class="token operator">$</span>main<span class="token punctuation">(</span>

        <span class="token comment"># wrap content in a section</span>
        tags<span class="token operator">$</span>section<span class="token punctuation">(</span>`aria<span class="token operator">-</span>labelledby`<span class="token operator">=</span><span class="token string">"title"</span><span class="token punctuation">,</span>

            <span class="token comment"># app title</span>
            tags<span class="token operator">$</span>h1<span class="token punctuation">(</span><span class="token string">"Custom JS Handlers"</span><span class="token punctuation">,</span> id<span class="token operator">=</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment"># a paragraph about the app</span>
            tags<span class="token operator">$</span>p<span class="token punctuation">(</span><span class="token string">"This shiny app demonstrates how to create your own javascript functions and register them with shiny server. In this example, we created a simple javascript that toggles a css class and stores the user's selection to local storage, as well as display the selected theme in the top right corner. Click the button."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            
            <span class="token comment"># theme toggle</span>
            tags<span class="token operator">$</span>button<span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token string">"toggleTheme"</span><span class="token punctuation">,</span> class<span class="token operator">=</span><span class="token string">"action-button shiny-bound-input"</span><span class="token punctuation">,</span> <span class="token string">"Toggle Theme"</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment"># load js</span>
    tags<span class="token operator">$</span>script<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token punctuation">,</span> src<span class="token operator">=</span><span class="token string">"js/index.js"</span><span class="token punctuation">)</span>

<span class="token punctuation">)</span></code></pre></div>
<p>It's important to note that if you are creating your own buttons, you will need to use the following css classes: <code>action-button shiny-bound-input</code> doing so will make the button available for use in the server. </p>
<p>I also didn't talk about the last <code>div</code>. That's a surprise for when you run the app and toggle themes!</p>
<span id="server" />
<h3>Defining the server</h3>
<p>Let's create a basic outline for our shiny server. It wouldn't have much at this point as we haven't written any javascript, but we can write the basics. We want our server to do two things.</p>
<ol>
<li>Set the default theme when the app is started</li>
<li>Toggle themes when the button is clicked</li>
</ol>
<p>Let's prep our server for this.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">server <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> output<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment"># set default theme</span>
    <span class="token comment"># ...some code will go here...</span>

    <span class="token comment"># event when button is clicked</span>
    observeEvent<span class="token punctuation">(</span>input<span class="token operator">$</span>toggleTheme<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        
        <span class="token comment"># ...some code will go here...</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span></code></pre></div>
<p>To pass information from R to javascript, our server function must have <code>session</code> stated.</p>
<span id="js" />
<h3>Writing the javascript functions</h3>
<p>Before we write our javascript, let's figure out what we need. So what do we really want our app really do? Let's revisit our list from earlier.</p>
<p>Our app will do three things.</p>
<ol>
<li>Toggle between a light and dark theme, and display the name of the current theme </li>
<li>Save the selected theme for later use</li>
<li>Load the last theme selected and set it as default when the app is started</li>
</ol>
<p>This gives us an idea of what we want our app to do conceptually, so let's work through each item to get a better idea of the specific functions we will need. </p>
<p><strong>1. Toggle between a light and dark theme</strong></p>
<p>All of our styles are defined in the css file and are associated with two classes: <code>.light-theme</code> and <code>.dark-theme</code>. We want to apply either style to an element (in our ui) of our choice so we will need a function that <strong>adds</strong> a theme to any element and one that <strong>removes</strong> a theme from any element. </p>
<p>We will need another function to tie these together as it's still unclear what theme we want to add if another theme is present. We will need a function that <strong>finds</strong> the current css theme. </p>
<p><strong>2. Save the selected theme for later use</strong></p>
<p>It would be great if we could <strong>save</strong> the selected theme so that when the user starts the app again, their last used theme is loaded by default. So let's write a function that <strong>saves</strong> this information somewhere.</p>
<p><strong>3. Load the last theme selected and set it as default when the app is started</strong></p>
<p>To apply the last used theme, we will need a function that retrieves the last used theme from wherever it is stored and apply it. So we will need some function to load our save preferences and then <strong>set it as default</strong>. </p>
<p>We also want to <strong>display</strong> the name of the current them on the page so we will need a function that sends the theme name to some output element.</p>
<p>To summarize, we will want seven functions: add a css class, remove a css class, find the css class (i.e., theme), save the current theme, load the last theme, set last theme as default theme, and a function to display the name of the current theme. </p>
<p>Let's start writing our functions.</p>
<h4>The Add and Remove functions</h4>
<p>First, we will write a function that adds our a css class to an element of our choice. We will use the function <code>querySelector()</code> to find our element that we name. We can access the classes of an element using <code>classList</code> and then apply a new class using <code>add()</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">addCSS</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">elem<span class="token punctuation">,</span> css</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>css<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The remove css function works in the same way except we will use <code>remove()</code> instead.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">removeCSS</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">elem<span class="token punctuation">,</span> css</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>css<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code>Document</code> is used as we are saying to look anywhere in our document for this element. <code>querySelector</code> is generally used for finding elements by class name, but it can also be used for finding elements by tag name, id, or other attribute. There are other selector methods available. See <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_object_model/Locating_DOM_elements_using_selectors">Locating DOM elements using selectors</a> for other methods. In this example, I'm using a single function for selecting elements for simplicity and demonstration purposes only. Ideally, you would want a function that selected elements by id (using <code>getElementById</code>) and another function that selects elements by class name (using <code>querySelector</code> or <code>querySelectorAll</code>). </p>
<h4>Finding the current theme</h4>
<p>How will we know what theme is already present? To determine the current theme, we will write a function that reads the css class of the element of our choice and returns the theme. We will also want to define a default theme for the app in the event there isn't one saved or it cannot be found.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// master app default theme</span>
<span class="token keyword">var</span> appDefaultTheme <span class="token operator">=</span> <span class="token string">"light-theme"</span><span class="token punctuation">;</span>

<span class="token comment">// find function</span>
<span class="token keyword">var</span> <span class="token function-variable function">findCSS</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> css <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> css <span class="token operator">===</span> <span class="token string">"undefined"</span> <span class="token operator">||</span> css <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> appDefaultTheme<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> css<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>To get the current css class of the element, the css classes will need to be converted into an array. Since we are only targeting the <code>&#x3C;body></code> element which has only one class, the function will take the first element in that array (hence the <code>[0]</code>). If you are targeting another element that has more classes applied, you will need to adjust position in the array that you want to select or you write another function that matches the classes with the class of your choice. Since our example is simple, we will stick to the basics.</p>
<p>This function also has some logic to determine if the css them is undefined (i.e., there aren't any classes applied) and to return a default (in this case light theme). The main reason for using a default theme is that shiny automatically creates the document body (<code>&#x3C;body></code>) as opposed to having to manually define it using <code>tags$body()</code>. We could easily set the default theme by calling <code>tags$body(class="light-theme")</code>. However, this would produce nested <code>&#x3C;body></code> tags. which isn't ideal and can cause some problems with selector paths. Instead, we will leave out the <code>tags$body()</code> and target the <code>&#x3C;body></code> tag with javascript.</p>
<h4>Save and load functions</h4>
<p>Next, we will write two functions that handle the storage and retrival of our theme preferences. We will write a generic function that saves whatever value we pass to <code>localStorage</code> and a function that loads the value from <code>localStorage</code>. We will use <code>setItem</code> for saving and <code>getItem</code> for loading.</p>
<blockquote>
<p>It's important to note that there are differences in storage methods. The <code>localStorage</code> method is fine for very basic information (like setting default themes), but it isn't really a good method for sensitive information. See this <a href="https://dev.to">dev.to</a> post on <a href="https://dev.to/caffiendkitten/localstorage-vs-sessionstorage-f9k">localStorage vs sessionStorage</a> for more information and links for further reading.</p>
</blockquote>
<p>Here's our save function.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">save</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>And the load function.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">load</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"theme"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>For more information, please vist Mozilla's <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API">Using the Web Storage API</a> article.</p>
<h4>Set default theme function</h4>
<p>Now that we have written our save and load functions, we can write our set default function. This function will load the information and apply the theme according to what was saved (using our addCSS function). We will also want some logic to set a default theme (to the element of our choice) if there isn't any information in our local storage. Here's the function.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">setDefault</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> defaultTheme <span class="token operator">=</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> defaultTheme <span class="token operator">===</span> <span class="token string">"undefined"</span> <span class="token operator">||</span> defaultTheme <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">addCSS</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> appDefaultTheme<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">addCSS</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> defaultTheme<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h4>Display current theme name</h4>
<p>Finally, we want to display the name of the theme in our app. We want to select the element of our choice and update it's content with the name of the current theme. We will use a different selector method from our add and remove functions. This time we will use <code>getElementById</code> and use <code>.innerHTML</code> to set the text of the element. </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">setInnerHTMLById</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    elem<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>There we have it! All of our javascript functions are written.</p>
<h4>Module Patterns</h4>
<p>Before we move on to registering our functions, I want to touch on another aspect of our js code. </p>
<p>If you look in the index.js file, you will notice that all of the js functions are assigned to a few objects <code>styles</code>, <code>file</code>, and <code>text</code>. The functions are structured in a <a href="https://www.freecodecamp.org/news/javascript-modules-a-beginner-s-guide-783f7d7a5fcc/">Revealing Module Pattern</a> which allows us to group similar functions into a single object and then use them as needed. This approach is recommended as it's good for decluttering the namespace and for resuability of functions across projects. Once you have written a series of modules, you can load your modules and start writing your javascript as normal without the need for rewritting or copy/pasting across projects.</p>
<p>These functions can be called by first specifying the object, and then the function. For example:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// use the save function</span>
file<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// use the add css function</span>
styles<span class="token punctuation">.</span><span class="token function">addCSS</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// use more than one </span>
<span class="token keyword">function</span> <span class="token function">myfunction</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    styles<span class="token punctuation">.</span><span class="token function">addCSS</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    text<span class="token punctuation">.</span><span class="token function">setInnerHTMLById</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<span id="registering" />
<h3>Registering the javascipt functions</h3>
<p>Let's register the js functions with shiny.</p>
<p>The two functions we will use are <code>session$sendCustomMessage</code> and <code>Shiny.addCustomMessageHandler</code>. <code>session$sendCustomMessage</code> is used to send information from our shiny server to our js functions. </p>
<ul>
<li><code>session$sendCustomMessage(type, message)</code>: this function is a R function that is used in the shiny server to send information to javascript. This function takes two arguments <code>type</code> (the name of our js handler) and <code>message</code> the information we want to send to our js handler. The information sent to javascript can be a single value, data objects, and more than one element. Note: the information/data passed through <code>message</code> will be returned as a javascript array.</li>
<li><code>Shiny.addCustomMessageHandler(type, function(message){...})</code>: this function is a js function that is used to receive the information from our shiny server. The argument <code>type</code> is a unique name for our handler and the <code>message</code> (or information sent from the shiny server) is passed into a function. </li>
</ul>
<p>(If you want to send information back to shiny, you can find more in Shiny's <a href="https://shiny.rstudio.com/articles/communicating-with-js.html">Communication with JS</a> article.)</p>
<p>In our app, we want to do two things.</p>
<ol>
<li>Toggle the theme when a button is clicked</li>
<li>Set the user's default theme when the app is loaded</li>
</ol>
<p>There isn't a need to register each function with shiny as this demo is pretty basic. Instead, we will write a handler for each action in our app.</p>
<h4><code>addCustomMessageHandler</code> for setting the default theme</h4>
<p>Our custom message handler for setting the default them will do two things: set the default theme and update the theme name in our status bar. We will also use our <code>styles.findCSS()</code> function to return the value of the default theme. </p>
<p>We will also need a unique name for our handler so we can call it from our server. Let's use <code>setDefaultTheme</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">shiny<span class="token punctuation">.</span><span class="token function">addCustomMessageHandler</span><span class="token punctuation">(</span><span class="token string">"setDefaultTheme"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">// run our set default function - the value is the name of the element we want to apply our style to</span>
    file<span class="token punctuation">.</span><span class="token function">setDefault</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> 

    <span class="token comment">// find the name of the theme applied and update text</span>
    <span class="token keyword">var</span> currentTheme <span class="token operator">=</span> styles<span class="token punctuation">.</span><span class="token function">findCSS</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    text<span class="token punctuation">.</span><span class="token function">setInnerHtmlById</span><span class="token punctuation">(</span><span class="token string">"themeStatus"</span><span class="token punctuation">,</span> currentTheme<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Notice that we haven't stated which element we want to apply the theme to. This value will come from the server.</p>
<h4><code>addCustomMessageHandler</code> for switching themes</h4>
<p>Let's write our handler for toggling themes. We want this handler to do a few things.</p>
<ol>
<li>Find the current theme (using <code>styles.findCSS()</code>)</li>
<li>Remove the current theme and add the new theme (using <code>styles.addCSS()</code> and <code>styles.removeCSS()</code>).</li>
<li>Update the display with the name of the current theme (using <code>text.setInnerHTMLById()</code>)</li>
<li>Save the selection (using <code>file.save()</code>)</li>
</ol>
<p>Let's also give it a unique name. I'll use <code>toggleTheme</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">Shiny<span class="token punctuation">.</span><span class="token function">addCustomMessageHandler</span><span class="token punctuation">(</span><span class="token string">"toggleTheme"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

   <span class="token comment">// find theme and init a var to write the name of the new theme</span>
    <span class="token keyword">var</span> currentTheme <span class="token operator">=</span> styles<span class="token punctuation">.</span><span class="token function">findCSS</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> newTheme <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

    <span class="token comment">// run logic</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTheme <span class="token operator">===</span> <span class="token string">"dark-theme"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        styles<span class="token punctuation">.</span><span class="token function">removeCSS</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">"dark-theme"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        styles<span class="token punctuation">.</span><span class="token function">addCSS</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">"light-theme"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        newTheme <span class="token operator">=</span> <span class="token string">"light-theme"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        styles<span class="token punctuation">.</span><span class="token function">removeCSS</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">"light-theme"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        styles<span class="token punctuation">.</span><span class="token function">addCSS</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">"dark-theme"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        newTheme <span class="token operator">=</span> <span class="token string">"dark-theme"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// save theme and update output element</span>
    text<span class="token punctuation">.</span><span class="token function">setInnerHtmlById</span><span class="token punctuation">(</span><span class="token string">"themeStatus"</span><span class="token punctuation">,</span> newTheme<span class="token punctuation">)</span><span class="token punctuation">;</span>
    file<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>newTheme<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>We are almost ready! Let's go back to our shiny server and call our handlers. </p>
<span id="js-running" />
<h3>Running the js functions from the server</h3>
<p>Since it's been a while, let's revist our list of what we want our app to do once more. We want our to do two things.</p>
<ol>
<li>Toggle the theme when a button is clicked</li>
<li>Set the user's default theme when the app is loaded</li>
</ol>
<p>To toggle the theme when a button is clicked can trigged using <code>observeEvent()</code>. We don't need to write any logic or functions for setting our default theme when the app is loaded as we want this to run when the app is started. We can simply place this at the top of our sever. </p>
<p>We will call our handlers by using <code>session$sendCustomMessage()</code>. Our handlers require one argument <code>value</code>. In this example, it's the name of the element we want to apply our theme to, which is the entire page or the <code>body</code> of our document.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">server <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> output<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment"># set default theme (only on app startup)</span>
    session<span class="token operator">$</span>sendCustomMessage<span class="token punctuation">(</span><span class="token string">"defaultTheme"</span><span class="token punctuation">,</span> <span class="token string">"body"</span><span class="token punctuation">)</span>

    <span class="token comment"># event when button is clicked</span>
    observeEvent<span class="token punctuation">(</span>input<span class="token operator">$</span>toggle<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        session<span class="token operator">$</span>sendCustomMessage<span class="token punctuation">(</span><span class="token string">"toggleTheme"</span><span class="token punctuation">,</span> <span class="token string">"body"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Perfect! That's it. Now, run the app and toggle the theme.</p>
<span id="know"/>
<h2>What do I need to know before I intergrate this into my app?</h2>
<p>A few tips before using this approach.</p>
<ol>
<li>Determine the information you want to save. Is it sensitive? If so, consider other methods and speak with a security specialist. This approach is fine for storing basic information (e.g., theme preferences), but I wouldn't use this for anything more.</li>
<li>The css should work for all browsers. I didn't use an autoprefixer for this demo. It is recommended to use a css autoprefixer before using in a production app.</li>
</ol>
<p>If you have any questions, feel free to open a new issue.</p>
<span id="run" />
<h2>How do I run the demo?</h2>
<p>You can run this demo by cloing the <a href="https://github.com/davidruvolo51/shinyAppTutorials">github repository</a> or by running the following code in R.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">install.packages<span class="token punctuation">(</span><span class="token string">"shiny"</span><span class="token punctuation">)</span>
shiny<span class="token operator">::</span>runGithub<span class="token punctuation">(</span>repo<span class="token operator">=</span><span class="token string">"shinyAppTutorials"</span><span class="token punctuation">,</span> username<span class="token operator">=</span><span class="token string">"davidruvolo51"</span><span class="token punctuation">,</span> subdir<span class="token operator">=</span><span class="token string">"js-handlers"</span><span class="token punctuation">)</span></code></pre></div></section><div class="article-footer"><p>Keywords</p><ul class="post-meta-tags article-tags" aria-label="post tags"><li><code class="tag tag-javascript">javascript</code></li></ul></div></article></div></div></main><footer class="footer"><h2>shinyTutorials</h2><ul class="menu footer-menu"></ul><ul class="menu footer-menu"><li class="menu-item"><a class="menu-link" href="https://www.twitter.com/dcruvolo"><svg class="icon menu-link-icon" height="30" width="30" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg>@dcruvolo</a></li><li class="menu-item"><a class="menu-link" href="https://github.com/davidruvolo51/shinyAppTutorials"><svg class="icon menu-link-icon" height="30" width="30" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>shinyAppTutorials</a></li><li class="menu-item"><a class="menu-link" href="https://davidruvolo51.github.io/portfolio/"><svg class="icon" width="50" height="50" viewBox="0 0 50 40" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="user" transform="translate(11.280196, 6.000000)" stroke="currentColor" stroke-width="2" fill="currentColor"><path d="M27.1829506,38.463564 C27.1829506,31.1581236 23.1247009,23.3692614 18.2303544,21.0113097 C16.8720034,20.3568962 15.4135775,20 13.9041559,20 C12.4962651,20 11.1176019,20.3104979 9.81412773,20.8833092 C4.68481072,23.1373859 0.63453826,31.6314453 0.63453826,39.073266" id="body"></path><circle id="head" cx="13.7198041" cy="9" r="9"></circle></g></svg>My Portfolio</a></li></ul></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  window.excludeGAPaths=[/^(?:\/preview\/(?:(?!(?:\/|^)\.).)*?)$/,/^(?:\/do\-not\-track\/me\/too\/)$/];
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-76117337-11',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-76117337-11', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tutorials/js-handlers/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-861713a6e6d99061f672.js"],"component---src-components-tutorials-js":["/component---src-components-tutorials-js-d53ebef395d5c90dcd9c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-b86b6c2dbf524e19eaab.js"],"component---src-pages-about-js":["/component---src-pages-about-js-e84b24137a4894d179ce.js"],"component---src-pages-gallery-index-js":["/component---src-pages-gallery-index-js-0b4caed180f04e35dc03.js"],"component---src-pages-index-js":["/component---src-pages-index-js-081bcc21e2c5112c63f8.js"],"component---src-pages-tutorials-index-js":["/component---src-pages-tutorials-index-js-c3e7453d0cfa7ddc4bf6.js"]};/*]]>*/</script><script src="/shinytutorials/component---src-components-tutorials-js-d53ebef395d5c90dcd9c.js" async=""></script><script src="/shinytutorials/ec800322c0f71b5715d75b0073f476a066af1f45-5dfcbcfd5bde2ac1f549.js" async=""></script><script src="/shinytutorials/commons-c531f5118f02e9104877.js" async=""></script><script src="/shinytutorials/styles-36681512479a843831b0.js" async=""></script><script src="/shinytutorials/app-861713a6e6d99061f672.js" async=""></script><script src="/shinytutorials/framework-e94c62ba7ecbd1156bac.js" async=""></script><script src="/shinytutorials/webpack-runtime-7f142a406dc5b8165a13.js" async=""></script></body></html>