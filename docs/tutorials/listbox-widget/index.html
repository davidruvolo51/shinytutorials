<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/shinytutorials/styles.778e8e112ec70b07731b.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2b2b2b}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#d4d0ab}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{color:windowText;background:window}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}@font-face{font-family:Open Sans;font-style:normal;font-weight:400;src:url(/shinytutorials/static/open-sans-v17-latin-regular-5f4d4bc11d64b6cb605b7030c1997270.eot);src:local("Open Sans Regular"),local("OpenSans-Regular"),url(/shinytutorials/static/open-sans-v17-latin-regular-5f4d4bc11d64b6cb605b7030c1997270.eot?#iefix) format("embedded-opentype"),url(/shinytutorials/static/open-sans-v17-latin-regular-33543c5cc5d88f5695dd08c87d280dfd.woff2) format("woff2"),url(/shinytutorials/static/open-sans-v17-latin-regular-de0869e324680c99efa1250515b4b41c.woff) format("woff"),url(/shinytutorials/static/open-sans-v17-latin-regular-049a929c5d81988b3ae6d2f985ca7aa5.ttf) format("truetype"),url(/shinytutorials/static/open-sans-v17-latin-regular-7aab4c13671282c90669eb6a10357e41.svg#OpenSans) format("svg")}@font-face{font-family:Open Sans;font-style:normal;font-weight:600;src:url(/shinytutorials/static/open-sans-v17-latin-600-ddacaf4a9db58cda27c76ce88c408546.eot);src:local("Open Sans SemiBold"),local("OpenSans-SemiBold"),url(/shinytutorials/static/open-sans-v17-latin-600-ddacaf4a9db58cda27c76ce88c408546.eot?#iefix) format("embedded-opentype"),url(/shinytutorials/static/open-sans-v17-latin-600-819af3d3abdc9f135d49b80a91e2ff4c.woff2) format("woff2"),url(/shinytutorials/static/open-sans-v17-latin-600-449d681cd6006390e1bee3c3a660430b.woff) format("woff"),url(/shinytutorials/static/open-sans-v17-latin-600-8f7128145a3c2b83923552a328df7cdc.ttf) format("truetype"),url(/shinytutorials/static/open-sans-v17-latin-600-e16f375be3c2a73b58255a02f6d3a9ce.svg#OpenSans) format("svg")}body,html{padding:0;margin:0;font-family:Open Sans,Helvetica,sans-serif;cursor:default;font-size:15pt}article,aside,footer,header,main,nav{padding:0;margin:0;display:block}h1,h2,h3,h4,h5,h6{display:block;color:#2a2c32;line-height:1.3;padding:0;margin:0 0 6px}p{color:#3f454b;line-height:1.6;padding:0;margin:0 0 12px}ol li,ul li{margin:0;padding:0;line-height:1.7}ol li p,ul li p{padding:0;margin:0;line-height:1}ol li a,ul li a{padding:0;margin:0;line-height:1.5}li{color:#3f454b;line-height:1.3}a{color:#5177b8;text-decoration:none;box-shadow:0 2px 0 #5177b8}blockquote{line-height:1.3}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:90%;font-size:12pt;padding:8px 8px 8px 12px;border-radius:0;border:none;background-color:#f6f6f6;box-shadow:inset 0 2px 2px #d8d8d8}img,input{display:block}img{width:100%}:not(pre)>code{font-size:14pt}.icon{display:inline-block;width:20px;height:20px}.gatsby-highlight{margin:24px 0;font-size:12pt;overflow:auto}.gatsby-highlight pre{border-radius:6px}.gatsby-resp-image-link{box-shadow:none}button{display:block;border:none;background:none;cursor:pointer}.btn,.btn-link{display:block;padding:4px;margin:8px 0;font-size:14px;background-color:transparent;border-left:3px solid transparent;text-align:center}.btn-primary,.btn-secondary{text-transform:uppercase;letter-spacing:2px;font-weight:600;border-radius:3px;padding:6px 12px}.btn-primary{background-color:#5177b8;border:2px solid #5177b8;color:#fff;padding:8px 12px}.btn-primary:focus,.btn-primary:hover{background-color:transparent;border-color:#5177b8;color:#5177b8}.btn-secondary{background-color:transparent;border:2px solid #5177b8;color:#5177b8}.btn-secondary:focus,.btn-secondary:hover{background-color:#5177b8;color:#f6f6f6;border-color:#5177b8}.btn-keyword{font-size:12pt;padding:4px 6px;border-radius:6px}.btn-keyword:focus,.btn-keyword:hover{color:#5177b8;font-weight:600;text-decoration:underline}.btn-keyword.selected{background-color:#5177b8;color:#f6f6f6}.btn-centered{width:100px;margin:24px auto 0}.nav{position:fixed;top:0;left:0;width:100%;padding:6px 0;display:-ms-grid;display:grid;grid-template-columns:65% 35%;grid-template-areas:"brandLink menuBtn";column-gap:0;row-gap:0;background-color:#fff;box-shadow:0 2px 6px rgba(0,0,0,.18);z-index:15}.nav .nav-item{display:flex;align-items:center}.nav .brand-link{grid-area:brandLink;color:#5177b8;font-weight:600;font-size:14pt;letter-spacing:2px;padding:0 0 0 16px;box-shadow:none}.nav .brand-link .brand-link-icon path{fill:#5177b8}.nav .navigation{display:block;position:absolute;top:48px;width:1px;height:1px;clip:rect(0 0 0 0);clip:rect(0,0,0,0);padding:32px 0;background-color:#fff;z-index:14}.nav .navigation .menu-item{display:block;text-align:center}.nav .navigation .menu-item .menu-link{font-size:16pt;box-shadow:none}.nav .navigation.expanded{width:100%;height:auto;clip:auto;box-shadow:0 6px 6px rgba(0,0,0,.18)}.nav .menu-btns{justify-content:flex-end;grid-area:menuBtn}.nav .menu-btns .menu-button{margin:0}.nav .menu-btns .menu-button #menuBtn{margin-right:16px}@media (min-width:742px){.nav{grid-template-areas:"brandLink navLinks menuBtns";grid-template-columns:.75fr 3fr 1fr}.nav .brand-link{padding-bottom:0;grid-area:brandLink}.nav .navigation{position:static;display:flex;width:100%;grid-area:navLinks;box-shadow:none;margin-left:12px}.nav .navigation .menu-item{display:inline-block;width:auto;margin:0 24px 0 0}.nav .navigation .menu-item .menu-link{font-size:11pt}.nav .navigation .menu-item:last-child{margin-right:0}.nav .menu-btns{justify-content:flex-end;grid-area:menuBtns}.nav .menu-btns .menu-button{margin:0}.nav .menu-btns .menu-button#themeToggle{margin-right:24px}.nav .menu-btns .menu-item:not(.visible){display:none}}.menu{width:100%;margin:0 auto;list-style:none;padding:6px 0}.menu .menu-item{display:block;padding:0;margin:0 0 12px}.menu .menu-item .menu-link{position:relative;text-transform:uppercase;font-size:11pt;letter-spacing:2px;font-weight:600;color:#5177b8;padding-bottom:4px;border-bottom:2px solid transparent}.menu .menu-item .menu-link .menu-link-icon{position:relative;padding-right:6px;top:4px}.menu .menu-item .menu-link .menu-link-icon path{fill:#5177b8}.menu .menu-item .menu-link:hover{border-bottom-color:#5177b8}@media screen and (min-width:972px){.menu .menu-item{display:inline-block;margin:0 18px 0 0}}.footer{margin:0;padding:62px 0;background-color:#2a2c32}.footer h2{display:block;width:85%;margin:0 auto;padding-top:12px;color:#d8d8d8;letter-spacing:2.5px}.footer .menu{list-style:none;width:85%;margin:12px auto;padding:0}.footer .menu .menu-item{margin-right:24px}.footer .menu .menu-item .menu-link{color:#d8d8d8;box-shadow:none}.footer .menu .menu-item .menu-link .menu-link-icon path{fill:#d8d8d8}.footer .menu .menu-item .menu-link:hover{border-bottom-color:#d8d8d8}.post{padding:32px;border-radius:6px}.post .post-image{background-position:50%;background-size:cover;margin-bottom:12px}.post .post-title,.post .post-title-link{position:relative}.post .post-title{margin:0;padding:0}.post .post-title-link a{color:#2a2c32;box-shadow:0 1px 0 #3f454b}.post .post-status{position:relative;left:24px;top:-2px;font-size:11pt;text-transform:uppercase;font-weight:600;letter-spacing:2px;padding:3px 6px;border-radius:6px;background-color:#f6f6f6}.post .post-status[data-value=New]{background-color:rgba(81,119,184,.1);color:#5177b8}.post .post-status[data-value=Favorite],.post .post-status[data-value=Popular]{background-color:rgba(34,135,116,.1);color:#218573}.post .post-desc{padding:0;margin:0 0 6px;width:100%}.post .post-date{display:inline-block;color:#3f454b;font-size:11pt;font-family:consolas,courier,sans-serif;margin-right:12px}.post .post-tags{display:block;padding:0;margin:0 0 16px;list-style:none;color:#3f454b}.post .post-tags li{display:inline-block;margin-right:12px}.post .post-tags li .tag{border-radius:6px;font-size:11pt;padding:5px 10px;background-color:#f6f6f6;font-family:consolas,courier,sans-serif}.post .post-tags li .tag:before{content:"#"}.post .post-tags li:first-child{margin-left:0}.post .post-link{display:block;text-align:center;text-transform:uppercase;font-size:12pt;letter-spacing:2px;text-decoration:none;border-radius:4px;padding:6px 0;font-weight:600;box-shadow:none}.post .post-link:hover{text-decoration:underline}.post.post-feature{margin:16px auto;background-color:#fff}.post.post-feature .post-link{margin:0 auto;border:1px solid #5177b8;background-color:#5177b8;color:#fff}.post.post-plain{background-color:#fff;margin-bottom:16px}.post.post-plain .post-link{border:1px solid #5177b8}.post.post-plain .post-link:hover{background-color:#5177b8;color:#fff}.post.no-results-post{text-align:center}.post-form{padding:32px;border-radius:0 0 6px 6px;background-color:#fff;border-top:4px solid #5177b8;margin-bottom:16px}.post-form .input-label{display:block;padding:0;margin:0;font-size:18pt;color:#3f454b;font-weight:600}.post-form .input-example{line-height:1.5;padding:0;font-size:12pt;color:#3f454b;margin:0 0 12px}@media screen and (min-width:972px){.post{max-width:872px}.post.post-plain .post-link,.post.post-plain .post-tags{display:inline-flex;justify-content:center;align-items:center}.post.post-plain .post-link{width:125px;float:right}.post-form{max-width:872px}}.hero{width:100%;padding:44px 0;display:flex;position:relative;justify-content:center;align-items:center;background-color:#fff;overflow:hidden}.hero.hero-index .hero-content{width:90%;margin:0 auto;padding:72px 0;z-index:2}.hero.hero-index .hero-content .hero-title{font-size:21pt;letter-spacing:2.5px}.hero.hero-index .hero-content .hero-subtitle{font-weight:600;font-size:32pt;letter-spacing:2px;line-height:1.2}.hero.hero-index .hero-content .hero-image{display:block;width:300px;margin:44px auto;box-shadow:0 12px 3px -6px rgba(0,0,0,.18)}.hero.hero-text .hero-content{width:90%;margin:0 auto;padding:82px 0 0}.hero.hero-text .hero-content p{margin:0}.hero.hero-style-1{background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIxNDQwcHgiIGhlaWdodD0iNjcxcHgiIHZpZXdCb3g9IjAgMCAxNDQwIDY3MSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48IS0tR2VuZXJhdG9yOiBTa2V0Y2ggNTkuMSAoODYxNDQpIC0gaHR0cHM6Ly9za2V0Y2guY29tLS0+PHRpdGxlPmhlcm8tYmstZ3JheTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGcgaWQ9IkJhY2tncm91bmRzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBpZD0iaGVyby1iay1ncmF5LWNvcHkiIGZpbGw9IiM1MTc3YjgiIGZpbGwtb3BhY2l0eT0iMC4zIj48cGF0aCBkPSJNLTEuMjk5NjU0ODNlLTE0LDAgTDE0NDAsMCBDMTQ0MCw5NS45MTQ2OTE5IDE0NDAsMTg1Ljk3MzIwOCAxNDQwLDI3MC4xNzU1NDcgQzE0NDAsMzU0LjM3Nzg4NyAxNDQwLDQ3OS4zMTkzNzEgMTQ0MCw2NDUgQzEyODYuMzEwNjIsNTg3Ljc4MzUyNiAxMTI0LjkxNjc3LDU1MS45MDgyNTQgOTU1LjgxODQ0NSw1MzcuMzc0MTgzIEM3MDIuMTcwOTU5LDUxNS41NzMwNzYgNDU2Ljc1MDAwNiw3NDYuNzg4NDcxIDIxNi4yNzE0MTEsNjQ1IEM3MS41NDI5NDAxLDU4My43NDAxMjEgMC45MjI0ODU1MDIsNTA2LjI2ODcxIDEuMDM5NTg1MDhlLTEzLDQxMS42MzcxNzIgQy0wLjA2NjI0ODYzNzQsNDA0Ljg0MTE3MyAtMC4wNjYyNDg2Mzc0LDM5NC4yOTU0NDkgLTEuNTgxMzczOTJlLTE0LDM4MCBMLTEuMjk5NjU0ODNlLTE0LDAgWiIgaWQ9Imhlcm8tYmstZ3JheSIvPjwvZz48L2c+PC9zdmc+);background-size:cover;background-position:50% 100%;background-repeat:no-repeat}@media (min-width:972px){.hero.hero-index .hero-content,.hero.hero-text .hero-content{width:100%;max-width:972px}.hero.hero-index .hero-content .hero-image,.hero.hero-text .hero-content .hero-image{transform:scale(1.25)}}.flex{display:flex}.flex .flex-child{display:block;width:100%;height:auto}.flex.flex-30x70-layout,.flex.flex-33x3-layout,.flex.flex-50x2-layout{width:100%;flex-wrap:wrap}@media (min-width:812px){.flex.flex-30x70-layout .flex-child{display:inline-block}.flex.flex-30x70-layout .flex-child:nth-child(odd){width:30%}.flex.flex-30x70-layout .flex-child:nth-child(2n){width:70%}.flex.flex-33x3-layout .flex-child{display:inline-block;width:33%}.flex.flex-50x2-layout .flex-child{display:inline-block}.flex.flex-50x2-layout .flex-child:nth-child(2n),.flex.flex-50x2-layout .flex-child:nth-child(odd){width:50%}}.article-profile{display:inline-flex;justify-content:center;align-items:center;margin-top:12px}.article-profile .profile-img{width:40px;border-radius:50%}.article-profile .profile-name{font-size:12pt;margin-left:6px;color:#3f454b}.article-hero{padding-bottom:0}.article-hero h1{font-size:13pt;text-transform:uppercase;letter-spacing:2px}.article-hero h2{font-size:28pt}.article-hero .article-dates,.article-hero .article-readtime{margin:0;line-height:1.5;font-size:11pt;text-transform:uppercase;letter-spacing:2px;padding:0}.article-hero .article-dates time,.article-hero .article-readtime time{font-weight:400}.article-hero .article-readtime{color:#5177b8}.article{width:100%;padding:32px 0;border-radius:6px;background-color:#fff}.article .article-abstract,.article .article-body,.article .article-footer,.article .article-title{display:block;width:90%;margin:0 auto}.article .article-title{text-align:center}.article .article-abstract{color:#3f454b;line-height:1.6}.article .article-abstract :not(h2){color:#3f454b}.article .article-body h2{padding:0;margin:24px 0 0}.article .article-body a{color:#5177b8}.article .article-body blockquote{background-color:#f6f6f6;padding:12px;margin:44px 0;border-left:10px solid #5177b8}.article .article-body blockquote p{margin:0}.article .article-body table{margin:16px 0}.article .article-footer{border-top:1px solid #a3a6a8;margin-top:12px;padding-top:12px}.article .article-footer .article-tags{display:inline-block;padding:0;margin:0;list-style:none;color:#3f454b}.article .article-footer .article-tags li{display:inline-block;margin-right:12px}.article .article-footer .article-tags li .tag{border-radius:6px;font-size:11pt;padding:5px 10px;background-color:#f6f6f6;font-family:consolas,courier,sans-serif}.article .article-footer .article-tags li .tag:before{content:"#"}.article .article-footer .article-tags li:first-child{margin-left:0}.article-toc h2{font-size:21pt}.article-toc ol{font-size:13pt}.article-toc ol li{margin-bottom:12px}.article-toc ol li ol{margin-top:12px;list-style:upper-alpha}.article-toc ol li ol li{margin-bottom:6px}.article-toc ol li ol li ol{list-style:lower-roman}.article-toc ol li:last-child,.article-toc ol li ol li:last-child{margin-bottom:0}.article-toc ol a{box-shadow:none}.article-toc ol a :focus,.article-toc ol a:hover{box-shadow:0 2px 0 0 #5177b8}@media (min-width:972px){.article{max-width:812px}}.main{padding:0;min-height:60vh}.main .full-section{width:100%}.main .full-section .full-section-content,.main .main-section{width:90%;margin:0 auto}.main .main-section{padding:24px 0}.main .filled-section{padding:44px 0}.main .filled-section:not(.welcome-section){background-color:#f6f6f6}.main .filled-section:not(.welcome-section) p:not(.post-desc){text-align:center}.main .filled-section h2{text-align:center;text-transform:uppercase;letter-spacing:2px;padding:0;margin:0}.main .filled-section:last-child{margin-bottom:0}.main .filled-section.welcome-section p{max-width:812px;margin:0 auto}@media (min-width:972px){.main .full-section .full-section-content,.main .main-section{max-width:972px}}.sidebar-layout{display:flex;width:100%;flex-wrap:wrap}.sidebar-layout .sidebar-panel{position:static;padding-top:50px}.sidebar-layout .sidebar-panel .sidebar-content{background-color:#fff;margin:0 auto;padding:32px;border-radius:6px}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title{display:block;width:100%}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle{position:relative;margin:0;padding:0;font-size:18pt}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon{position:absolute;top:4px;margin-left:12px;transform:rotate(-45deg);transform-origin:center center;transition:all .3s ease-in-out}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon circle{fill:#f6f6f6}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon line{stroke:#5177b8}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-title .sidebar-toggle .sidebar-toggle-icon.rotated{transform:rotate(0)}.sidebar-layout .sidebar-panel .sidebar-content .sidebar-caption{margin:0 0 12px;line-height:1.3;font-size:14pt}.sidebar-layout .sidebar-panel .sidebar-content .taglist{list-style:none;padding:0;margin:0 0 16px -6px}.sidebar-layout .sidebar-panel .sidebar-content .taglist .taglist-item{width:200px;padding:0 24px 0 0;margin-bottom:12px;cursor:pointer}.sidebar-layout .sidebar-panel .sidebar-content.expanded{position:absolute;width:1px;height:1px;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);overflow:hidden}.sidebar-layout .main-panel{padding-top:50px}.sidebar-layout .main-panel,.sidebar-layout .sidebar-panel{width:90%;margin:0 auto}@media (min-width:972px){.sidebar-layout .sidebar-panel{width:30%;max-width:500px;margin:0 auto;position:-webkit-sticky;position:sticky;top:62px;height:100%}.sidebar-layout .sidebar-panel .sidebar-content{width:70%;max-height:565px}.sidebar-layout .sidebar-panel .sidebar-content .scroll-container{box-sizing:content-box;padding:.7em 1em;margin:1em 0;max-height:430px;overflow-y:auto;box-shadow:inset 0 0 4px 1px rgba(0,0,0,.18)}.sidebar-layout .main-panel{width:70%}}#menuBtn{display:flex;justify-content:center;align-items:center;background-color:transparent}#menuBtn .menu-icon{display:block;margin:0 auto;position:relative}#menuBtn .menu-icon .menu-bar{display:block;height:3px;width:30px;border-radius:6px;margin-bottom:6px;background-color:#5177b8;transition:all .2s ease-in-out}#menuBtn .menu-icon .menu-bar:first-child{margin-top:2px}#menuBtn.open .menu-bar:first-child{opacity:0}#menuBtn.open .menu-bar:nth-child(2){transform:rotate(-45deg);transform-origin:center .5px;background-color:#5177b8}#menuBtn.open .menu-bar:nth-child(3){transform:rotate(45deg);transform-origin:24.85px -2.5px;background-color:#5177b8}#menuBtn.open .menu-label{color:#5177b8}.article table,.datatable{width:100%;margin:12px auto;font-weight:400;border-spacing:0;text-align:left;font-size:13pt}.article table caption,.datatable caption{text-align:left;font-size:16pt;margin:12px 0;color:#2a2c32;font-weight:600}.article table thead tr th,.datatable thead tr th{font-weight:600;text-transform:uppercase;letter-spacing:2px;font-size:11pt;padding:4px 12px;border-bottom:2px solid #2a2c32;color:#2a2c32}.article table tbody tr td,.datatable tbody tr td{padding:8px 12px}.article table tbody tr td .hidden-colname,.datatable tbody tr td .hidden-colname{display:none}.article table tbody tr:nth-child(2n),.datatable tbody tr:nth-child(2n){background-color:#f6f6f6}@media (max-width:892px){.datatable thead{display:none}.datatable tbody tr{display:block;margin-bottom:16px;counter-increment:rowCounter}.datatable tbody tr:nth-child(2n){background-color:transparent}.datatable tbody tr td{display:block;padding:6px 0 6px 6px;color:#3f454b}.datatable tbody tr td:first-child{font-size:16pt;color:#2a2c32}.datatable tbody tr td:first-child:before{content:counter(rowCounter) ".";display:inline-block;margin-right:4px;font-size:15pt}.datatable tbody tr td:not(:first-child){border-bottom:1px solid #f6f6f6}.datatable tbody tr td .hidden-colname{display:inline-block;width:150px}.datatable tbody tr td .hidden-colname:after{content:":"}.datatable-container{display:block;width:100%;overflow-x:scroll}}.visually-hidden{position:absolute;width:1px;height:1px;clip:rect(0 0 0 0);clip:rect(0,0,0,0);overflow:hidden}#theme-toggle-icon path{fill:#5177b8}.tutorial-index{padding:0 0 66px;background-color:#f6f6f6}.tutorial-index .tutorial-index-posts{padding:32px 0}.tutorial-index .tutorial-index-posts h2{padding-left:32px;margin-bottom:32px}.tutorial{padding:0 0 50px}.about-page,.tutorial{background-color:#f6f6f6}.about-page #repos .column-4,.about-page #repos .column-5,.about-page #repos .column-6,.about-page #repos thead th:nth-child(n+4){text-align:left}.privacy-page{background-color:#f6f6f6}@media (min-width:972px){.related-projects .post.post-feature,.tutorial-latest .post.post-feature{max-width:40%}.related-projects .post.post-feature:nth-child(odd),.tutorial-latest .post.post-feature:nth-child(odd){margin-right:32px}.tutorial-index .tutorial-index-posts{padding-top:82px}.about-page #repos .column-4,.about-page #repos .column-5,.about-page #repos .column-6,.about-page #repos thead th:nth-child(n+4){text-align:right}.gallery-page .post .post-link{width:250px}}body[data-theme=dark],body[data-theme=dark] h1,body[data-theme=dark] h2,body[data-theme=dark] h3,body[data-theme=dark] h4{color:#f6f6f6}body[data-theme=dark] p{color:#d8d8d8}body[data-theme=dark] a{color:#d8d8d8;text-decoration:none;box-shadow:0 2px 0 #f6f6f6}body[data-theme=dark] a.btn{box-shadow:none}body[data-theme=dark] ol li,body[data-theme=dark] ul li{color:#d8d8d8}body[data-theme=dark] :not(pre)>code[class*=language-],body[data-theme=dark] pre[class*=language-]{background:#13141b}body[data-theme=dark] .hero-image #dashboard rect#background{fill:#3f454b}body[data-theme=dark] .menu .menu-item .menu-link:hover{border-bottom-color:#f6f6f6}body[data-theme=dark] .nav{background-color:#2a2c32}body[data-theme=dark] .nav .nav-item{background-color:#2a2c32;color:#f6f6f6}body[data-theme=dark] .nav .navigation .menu-item .menu-link{color:#f6f6f6}body[data-theme=dark] .nav .menu-btns #themeToggle path,body[data-theme=dark] .nav .navigation .menu-item .menu-link .menu-link-icon path{fill:#f6f6f6}body[data-theme=dark] .nav .menu-btns #menuBtn .menu-icon .menu-bar{background-color:#f6f6f6}body[data-theme=dark] .hero{background-color:#2a2c32}body[data-theme=dark] .hero.article-hero,body[data-theme=dark] .hero.hero-text{position:relative;background-color:#2a2c32;overflow:hidden}body[data-theme=dark] .hero.article-hero:before,body[data-theme=dark] .hero.hero-text:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(81,119,184,.1);z-index:1}body[data-theme=dark] .hero.article-hero .hero-content .article-readtime,body[data-theme=dark] .hero.article-hero .hero-content .profile-name,body[data-theme=dark] .hero.hero-text .hero-content .article-readtime,body[data-theme=dark] .hero.hero-text .hero-content .profile-name{color:#d8d8d8}body[data-theme=dark] .main,body[data-theme=dark] .main .filled-section,body[data-theme=dark] .main .full-section,body[data-theme=dark] .main .main-section{background-color:#2a2c32}body[data-theme=dark] .post{background-color:#3f454b}body[data-theme=dark] .post h3 a{color:#d8d8d8}body[data-theme=dark] .post .post-date{color:#f6f6f6}body[data-theme=dark] .post .post-tags .tag{color:#2a2c32;background-color:#d8d8d8}body[data-theme=dark] .post .post-status[data-value=New]{background-color:#2a2c32;color:#d8d8d8}body[data-theme=dark] .post .post-status[data-value=Favorite],body[data-theme=dark] .post .post-status[data-value=Popular]{background-color:#218573;color:#f6f6f6}body[data-theme=dark] .tutorial-index{background-color:#2a2c32}body[data-theme=dark] .tutorial-index #reset,body[data-theme=dark] .tutorial-index .post.post-plain .post-link{background-color:#5177b8;color:#f6f6f6}body[data-theme=dark] .sidebar-layout{background-color:#2a2c32}body[data-theme=dark] .form,body[data-theme=dark] .sidebar-layout .sidebar-panel .sidebar-content{background-color:#3f454b}body[data-theme=dark] .form label,body[data-theme=dark] .form p{color:#d8d8d8}body[data-theme=dark] #search{background-color:#d8d8d8}body[data-theme=dark] .btn-keyword{color:#f6f6f6}body[data-theme=dark] .btn-keyword.selected,body[data-theme=dark] .btn-keyword:hover{border-left-color:#f6f6f6}body[data-theme=dark] .tutorial .sidebar-layout .sidebar-panel .sidebar-content{background-color:rgba(81,119,184,.1)}body[data-theme=dark] .tutorial .sidebar-layout .sidebar-panel .sidebar-content a{box-shadow:none}body[data-theme=dark] .tutorial .sidebar-layout .sidebar-panel .sidebar-content a:hover{box-shadow:0 2px 0 #d8d8d8}body[data-theme=dark] .tutorial .article{background-color:#2a2c32}body[data-theme=dark] .tutorial .article .article-abstract p,body[data-theme=dark] .tutorial .article a{color:#d8d8d8}body[data-theme=dark] .tutorial .article blockquote{background-color:#3f454b}body[data-theme=dark] .tutorial .article blockquote p{color:#f6f6f6}body[data-theme=dark] .tutorial .article .article-tags li code{background-color:#3f454b}body[data-theme=dark] .tutorial .article table{background-color:rgba(81,119,184,.1);padding:6px}body[data-theme=dark] .tutorial .article table thead tr th{color:#f6f6f6;border-bottom-color:#f6f6f6}body[data-theme=dark] .tutorial .article table tbody tr{background-color:transparent}body[data-theme=dark] .tutorial .article table tbody tr td{border-bottom:1px solid #a3a6a8}body[data-theme=dark] .tutorial .article table tbody tr:nth-child(2n){background-color:transparent}body[data-theme=dark] .tutorial .article table tbody tr:last-child td{border-bottom:none}body[data-theme=dark] .datatable{background-color:rgba(81,119,184,.1);padding:6px}body[data-theme=dark] .datatable thead tr th{color:#f6f6f6;border-bottom-color:#f6f6f6}body[data-theme=dark] .datatable tbody tr{background-color:transparent}body[data-theme=dark] .datatable tbody tr td{border-bottom:1px solid #a3a6a8;color:#f6f6f6}body[data-theme=dark] .datatable tbody tr td:last-child{border-bottom:none}body[data-theme=dark] .datatable tbody tr:nth-child(2n){background-color:transparent}@media (min-width:972px){body[data-theme=dark] .datatable tbody tr td:last-child{border-bottom:1px solid #a3a6a8}body[data-theme=dark] .datatable tbody tr:last-child td{border-bottom:none}}</style><meta name="generator" content="Gatsby 2.32.3"/><link rel="icon" href="/shinytutorials/favicon-32x32.png?v=a47592f83f89521a651df94e324b1d95" type="image/png"/><link rel="manifest" href="/shinytutorials/manifest.webmanifest" crossorigin="use-credentials"/><link rel="apple-touch-icon" sizes="48x48" href="/shinytutorials/icons/icon-48x48.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="72x72" href="/shinytutorials/icons/icon-72x72.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="96x96" href="/shinytutorials/icons/icon-96x96.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="144x144" href="/shinytutorials/icons/icon-144x144.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="192x192" href="/shinytutorials/icons/icon-192x192.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="256x256" href="/shinytutorials/icons/icon-256x256.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="384x384" href="/shinytutorials/icons/icon-384x384.png?v=a47592f83f89521a651df94e324b1d95"/><link rel="apple-touch-icon" sizes="512x512" href="/shinytutorials/icons/icon-512x512.png?v=a47592f83f89521a651df94e324b1d95"/><title data-react-helmet="true">shinyTutorials | Listbox Widget</title><meta data-react-helmet="true" name="description" content="Listbox Widget Creating a customizable dropdown menu component for Shiny"/><meta data-react-helmet="true" property="og:title" content="Listbox Widget"/><meta data-react-helmet="true" property="og:description" content="Listbox Widget Creating a customizable dropdown menu component for Shiny"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="dcruvolo"/><meta data-react-helmet="true" name="twitter:title" content="Listbox Widget"/><meta data-react-helmet="true" name="twitter:description" content="Listbox Widget Creating a customizable dropdown menu component for Shiny"/><meta data-react-helmet="true" name="keywords" content="html, javascript"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="shinytutorials latest posts" href="/shinytutorials/rss.xml"/><link as="script" rel="preload" href="/shinytutorials/webpack-runtime-aa775fcdbf62117df72d.js"/><link as="script" rel="preload" href="/shinytutorials/app-af082cdb16f53309bbdd.js"/><link as="script" rel="preload" href="/shinytutorials/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/shinytutorials/commons-e415ca64c704e109fced.js"/><link as="script" rel="preload" href="/shinytutorials/ec800322c0f71b5715d75b0073f476a066af1f45-b3608908e1193b5aeda5.js"/><link as="script" rel="preload" href="/shinytutorials/component---src-components-tutorials-js-0547688c067af1285829.js"/><link as="fetch" rel="preload" href="/shinytutorials/page-data/tutorials/listbox-widget/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/shinytutorials/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/shinytutorials/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="nav" role="navigation"><a class="nav-item brand-link" href="/shinytutorials/">shinyTutorials</a><ul class="menu nav-item navigation "></ul><ul class="nav-item menu menu-btns"><li class="menu-item menu-button visible"><button id="themeToggle" class="menu-button"><span class="visually-hidden">toggle theme</span><svg id="theme-toggle-icon" class="icon theme-icon" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>toggle theme</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="light-bulb" fill="#000000"><path d="M11,11.8999819 C13.2822403,11.4367116 15,9.41895791 15,7 C15,4.23857625 12.7614237,2 10,2 C7.23857625,2 5,4.23857625 5,7 C5,9.41895791 6.71775968,11.4367116 9,11.8999819 L9,14 L11,14 L11,11.8999819 Z M13,13.3263688 C15.3649473,12.2029049 17,9.79239596 17,7 C17,3.13400675 13.8659932,0 10,0 C6.13400675,0 3,3.13400675 3,7 C3,9.79239596 4.63505267,12.2029049 7,13.3263688 L7,16 L13,16 L13,13.3263688 Z M7,17 L13,17 L13,18.5 C13,19.3284271 12.3349702,20 11.501424,20 L8.49857602,20 C7.67093534,20 7,19.3342028 7,18.5 L7,17 Z" id="Combined-Shape"></path></g></g></svg></button></li><li class="menu-item menu-button"><button id="menuBtn" class="" aria-expanded="false"><span class="visually-hidden">open or close menu</span><span class="menu-icon" aria-hidden="true"><span class="menu-bar"></span><span class="menu-bar"></span><span class="menu-bar"></span></span></button></li></ul></nav><header class="hero hero-index article-hero"><div class="hero-content"><h1 class="hero-title"></h1><h2 class="hero-subtitle"></h2><h1>Listbox Widget</h1><h2>Creating a customizable dropdown menu component for Shiny</h2><p class="article-dates">Published: <time>2020-09-03</time></p><p class="article-readtime"><time>20</time> minute read</p><div class="article-profile"><img class="profile-img" src="/shinytutorials/static/dcruvolo-16a2e1e5e48ba95aed1c754fd7fd0d57.jpeg" alt="@dcruvolo"/><span class="profile-name">@dcruvolo</span></div></div></header><main id="main" class="main tutorial" aria-label="main content"><div class="sidebar-layout"><aside class="sidebar-panel article-toc"><section class="sidebar-content"><h2 class="sidebar-title">Contents</h2><div class="scroll-container">
<ol>
<li><a href="#about">Why would I need this?</a></li>
<li>
<p><a href="#work">How does the listbox widget work?</a></p>
<ol>
<li>
<p><a href="#work-r">Building the R Component</a></p>
<ol>
<li><a href="#work-r-listbox-toggle">Listbox Toggle</a></li>
<li><a href="#work-r-listbox-options">Listbox Options</a></li>
<li><a href="#work-r-listbox-list">Listbox List</a></li>
<li><a href="#work-r-listbox">Main Listbox function</a></li>
</ol>
</li>
<li>
<p><a href="#work-js">Creating the JavaScript Input Bindings</a></p>
<ol>
<li><a href="#work-js-initialize">initialize</a></li>
<li><a href="#work-js-getValue">getValue</a></li>
<li><a href="#work-js-subscribe">subscribe</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="#know">What do I need to know before I integrate this into my app?</a></li>
<li><a href="#run">How do I run the demo</a></li>
<li><a href="#further-reading">Further reading</a></li>
</ol>
</div></section></aside><div class="main-panel tutorial-body"><article class="article"><section class="article-abstract"><h2>Overview</h2><p>Select inputs are commonly used in Shiny for creating dropdown menus. Select inputs are easy to use, but they are not easy to style using CSS. An alternative solution is the listbox widget.</p></section><section class="article-body">
<span id="about" />
<h2>Why would I need this?</h2>
<p>In the post <a href="./../select-input-styling/">Custom Select Inputs</a>, I demonstrated the use of the <code>appearance</code> CSS property for styling select inputs. However, that approach can cause the element to render differently across browsers making the web experience inconsistent. Using a well-designed component library will help with this, but it usually involves loading a large library into your app just to use a single component. Other solutions involve some creative markup and CSS, but it is not guaranteed that these approaches are accessible for individuals who use assistive web devices. Instead, it is possible to create your own dropdown menu by creating using the <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/listbox_role">listbox</a> role.</p>
<p>In this post, I will provide an overview for creating your own listbox widget using HTML, CSS, and JavaScript. The Web Accessibility Initiative's (WAI) Authoring Practices for creating a <a href="https://www.w3.org/TR/wai-aria-practices/#Listbox">listbox widget</a> is used to ensure the widget follows recommended accessibility practices. The example discussed in the post reworks the <a href="https://www.w3.org/TR/wai-aria-practices/examples/listbox/listbox-collapsible.html">Collapsible Dropdown Listbox Example</a> for use in Shiny applications, including writing the R functions that generate the HTML and creating the custom JavaScript input binding that handles the communication between R and the listbox widget.</p>
<blockquote>
<p>This tutorial focuses heavily on HTML and JavaScript. Some experience will definitely help, but it is not required. I have tried to keep concepts simple and reference outside sources where possible. If you notice any errors or have suggestions for improving this post, feel free to open a new <a href="https://github.com/davidruvolo51/shinytutorials/issues">issue</a> on GitHub.</p>
</blockquote>
<span id="work" />
<h2>How does the listbox widget work?</h2>
<p>In this post, I will cover the basics for creating the listbox widget.</p>
<ol>
<li>Building the R component</li>
<li>Creating the JavaScript input binding</li>
</ol>
<p>Before we dive in, let's create the required files. Add the following files to your Shiny project.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">my-project/
  R/
    listbox.R
  www/
    css / 
      listbox.css
    js/
      listbox.js
  ...</code></pre></div>
<p>You can place the CSS and JS files wherever you like as long as they are in the <code>www</code> folder. As of Shiny 1.5, files located in the <code>R/</code> folder are loaded automatically. </p>
<p>Checkout the <a href="https://github.com/davidruvolo51/shinyAppTutorials/tree/prod/shiny-listbox">listbox sub-repository</a> on GitHub for CSS code. I wanted to keep this post short and focus mainly on the HTML and JavaScript code. All styles were written in SASS and compiled to CSS using the application bundler <a href="http://parceljs.org">Parcel</a>. The CSS file is located in the file <a href="https://github.com/davidruvolo51/shinyAppTutorials/blob/prod/shiny-listbox/src/listbox.scss"><code>src/listbox.scss</code></a> and the compiled CSS file can be found at <a href="https://github.com/davidruvolo51/shinyAppTutorials/blob/prod/shiny-listbox/www/css/listbox.css"><code>www/css/listbox.css</code></a>. If you are using vanilla CSS, load the <code>listbox.css</code> file directly into your app or copy the contents into your app's primary CSS file.</p>
<span id="work-r" />
<h3>Building the R component</h3>
<p>In this section, we will be working from the <code>listbox.R</code> file.</p>
<p>First, we will write the R functions that render the HTML markup and required attributes for the listbox widget. Using the <a href="https://www.w3.org/TR/wai-aria-practices/examples/listbox/listbox-collapsible.html">Collapsible Dropdown Listbox Example</a> as a guide, the markup requires a several HTML elements and ARIA attributes. Take a look at the example's <a href="https://www.w3.org/TR/wai-aria-practices/examples/listbox/listbox-collapsible.html#sc">HTML source code</a> as this will help determine what the R functions should return.</p>
<ul>
<li>Container: In the example, they used a <code>&#x3C;div></code> element to wrap the component. We can use a <code>&#x3C;div></code> as the listbox container, but I opted for the <code>&#x3C;fieldset></code> element as I would primarily use the listbox element inside a <code>&#x3C;form></code>. The <code>&#x3C;fieldset></code> element can be accessed using the <code>tags$fieldset</code> object.</li>
<li>Title: The title describes the listbox widget and its elements. Since I am using the <code>&#x3C;fieldset></code> element, then <code>&#x3C;legend></code> is the most appropriate element. (Accessed by <code>tags$legend</code>)</li>
<li>Label: A label may also be useful as it provides additional context for the listbox widget. For example, if you were building a form where users select their preferred day of the week for scheduling appointments, a label could be used to give additional information about days and time an office is open (e.g., "We are only open on Mondays and Tuesdays"). I will use the <code>&#x3C;span></code> element for this (<code>tags$span</code>).</li>
<li>Toggle: The listbox widget requires a <code>&#x3C;button></code> that opens and closes the widget. The text inside the button will be used to display the current value. I will also add an SVG icon to indicate that the button can be clicked and that there is expandable content.</li>
<li>List of options: For the <code>&#x3C;select></code> elements, options are created using the <code>&#x3C;option></code> element, but this is not available for listboxes. Instead, I will use an unordered list (<code>&#x3C;ul></code>; <code>tags$ul</code>) and each option is created using a list item (<code>&#x3C;li></code>; <code>tags$li</code>) with the attribute <code>role = "option"</code>.</li>
</ul>
<p>Using the above list, here is the listbox HTML markup that we want the R functions to generate. I will talk about the required HTML- and ARIA attributes as we start writing the R functions.</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldset</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>legend</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>legend</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>A longer description<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Currently Selected Option<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">></span></span>Icon<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>Option 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>Option 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>Option 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldset</span><span class="token punctuation">></span></span></code></pre></div>
<p>How do we generate the HTML markup from R? Since there several HTML elements need to be created and linked with each other (via HTML attributes), and options need to be dynamically generated, I will create a primary function (or parent function) that calls several helper functions. The primary function will generate the IDs that link the child elements and pass this information for use in the helper functions. These helper functions are listed below.</p>
<ol>
<li><code>list_toggle</code>: I will create a function that renders the markup for the <code>&#x3C;button></code>. This includes the text element that will display the selected option and an SVG icon that visually indicates the button can be clicked.</li>
<li><code>input_list_item</code>: Each option should be generated individually. This function generates a single list item that has an SVG icon (that will be visible when the option is selected) and an inner text label that displays the value of the option. Several attributes are also needed for good web accessibility practices and for communication between R and the JavaScript input binding (this will be discussed in a later section).</li>
<li><code>input_list</code>: This helper function dynamically generates a list (<code>&#x3C;ul></code>) of options based on the number of input values (via the <code>input_list_item</code> function).</li>
<li><code>listbox</code>: This the main function that will be used in your shiny app. This function runs the helper functions and generates the list of options. It also renders the title and description (if applicable).</li>
</ol>
<p>I will nest the helper functions (items 1 through 3) in list object.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">helpers <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>The icons used in this package are available in <a href="https://github.com/davidruvolo51/rheroicons">rheroicons</a> package. The rheroicons package is the R version of the <a href="https://github.com/tailwindlabs/heroicons">heroicons</a> library.</p>
<span id="work-r-listbox-toggle" />
<h4>Listbox toggle</h4>
<p>The first helper function is the <code>list_toggle</code> function. This function generates the markup for the <code>&#x3C;button></code> that open and closes the list of options. Inside the button, the function will render a text label (that displays the current value) and an SVG icon (that visually indicates the button can be opened or closed). For good web accessibility practices, we will add the ARIA attributes <code>aria-haspopup</code>, <code>aria-expanded</code>, and <code>aria-labelledby</code>. I will also add a custom <code>data-*</code> attribute which may be useful selecting the button in CSS or JavaScript.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">helpers<span class="token operator">$</span>list_toggle <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> titleId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    buttonId <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> <span class="token string">"__"</span><span class="token punctuation">,</span> <span class="token string">"toggle"</span><span class="token punctuation">)</span>
    buttonLabelId <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>buttonId<span class="token punctuation">,</span> <span class="token string">"_label"</span><span class="token punctuation">)</span>

    tags<span class="token operator">$</span>button<span class="token punctuation">(</span>
        id <span class="token operator">=</span> buttonId<span class="token punctuation">,</span>
        class <span class="token operator">=</span> <span class="token string">"listbox-toggle"</span><span class="token punctuation">,</span>
        `data<span class="token operator">-</span>group` <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
        `aria<span class="token operator">-</span>haspopup` <span class="token operator">=</span> <span class="token string">"listbox"</span><span class="token punctuation">,</span>
        `aria<span class="token operator">-</span>expanded` <span class="token operator">=</span> <span class="token string">"false"</span><span class="token punctuation">,</span>
        `aria<span class="token operator">-</span>labelledby` <span class="token operator">=</span> paste0<span class="token punctuation">(</span>titleId<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> buttonLabelId<span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment"># text element for current selected item</span>
        tags<span class="token operator">$</span>span<span class="token punctuation">(</span>
            id <span class="token operator">=</span> buttonLabelId<span class="token punctuation">,</span>
            class <span class="token operator">=</span> <span class="token string">"toggle-text"</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment"># icon</span>
        rheroicons<span class="token operator">::</span>icons<span class="token operator">$</span>chevron_down<span class="token punctuation">(</span>
            type <span class="token operator">=</span> <span class="token string">"solid"</span><span class="token punctuation">,</span>
            aria_hidden <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
            class <span class="token operator">=</span> <span class="token string">"toggle-icon"</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The values for the arguments <code>inputId</code> and <code>titleId</code> are defined by the primary function. These values are used to link the legend and selected option label. The <code>aria-expanded</code> attribute informs users who use assistive web technologies if the list is visible or not (this attribute will be updated in the input binding).</p>
<span id="work-r-listbox-options" >
<h4>Listbox options</h4>
<p>Next, I will write the <code>input_list_item</code> function that generates each option. The returned element will have a label the displays the option and an SVG icon that will be visible when an option is selected. In addition, each option must have the attribute <code>role = "option"</code>.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">helpers<span class="token operator">$</span>input_list_item <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> option<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    forId <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> <span class="token string">"__"</span><span class="token punctuation">,</span> option<span class="token punctuation">)</span>

    <span class="token comment"># generate html</span>
    tags<span class="token operator">$</span>li<span class="token punctuation">(</span>
        id <span class="token operator">=</span> forId<span class="token punctuation">,</span>
        class <span class="token operator">=</span> <span class="token string">"listbox-option"</span><span class="token punctuation">,</span>
        role <span class="token operator">=</span> <span class="token string">"option"</span><span class="token punctuation">,</span>
        `data<span class="token operator">-</span>value` <span class="token operator">=</span> value<span class="token punctuation">,</span>
        `data<span class="token operator">-</span>group` <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
        `aria<span class="token operator">-</span>labelledby` <span class="token operator">=</span> forId<span class="token punctuation">,</span>

        <span class="token comment"># selected icon</span>
        rheroicons<span class="token operator">::</span>icons<span class="token operator">$</span>check_circle<span class="token punctuation">(</span>
            type <span class="token operator">=</span> <span class="token string">"solid"</span><span class="token punctuation">,</span>
            aria_hidden <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
            class <span class="token operator">=</span> <span class="token string">"option-icon"</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment"># label</span>
        tags<span class="token operator">$</span>span<span class="token punctuation">(</span>
            id <span class="token operator">=</span> paste0<span class="token punctuation">(</span>forId<span class="token punctuation">,</span> <span class="token string">"-input-label"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            class <span class="token operator">=</span> <span class="token string">"option-text"</span><span class="token punctuation">,</span>
            option
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The values for the arguments <code>inputId</code>, <code>option</code>, and <code>value</code> are passed down via the <code>input_list</code> function. I have also added a few custom data attributes that will be useful for selecting elements in CSS or the input binding.</p>
<span id="work-r-listbox-list" />
<h4>Listbox list</h4>
<p>The <code>input_list_item</code> function can then create be used in the <code>input_list</code> function to dynamically generate options. The returned element is an unordered list (<code>&#x3C;ul></code>). This element must have the attribute <code>role = "listbox"</code> and the attribute <code>tabindex = "0"</code> (as it will make the element focusable via the input binding). The ARIA attribute <code>aria-labelledby</code> is used to link the label and the list of options.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">helpers<span class="token operator">$</span>input_list <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> titleId<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment"># generate markup for parent element</span>
    parent <span class="token operator">&lt;-</span> tags<span class="token operator">$</span>ul<span class="token punctuation">(</span>
        id <span class="token operator">=</span> paste0<span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> <span class="token string">"__input_list"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        class <span class="token operator">=</span> <span class="token string">"listbox-list hidden"</span><span class="token punctuation">,</span>
        `data<span class="token operator">-</span>group` <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
        `aria<span class="token operator">-</span>labelledby` <span class="token operator">=</span> titleId<span class="token punctuation">,</span>
        role <span class="token operator">=</span> <span class="token string">"listbox"</span><span class="token punctuation">,</span>
        tabindex <span class="token operator">=</span> <span class="token string">"-1"</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># generate markup for child (&lt;li>) elements</span>
    children <span class="token operator">&lt;-</span> lapply<span class="token punctuation">(</span>seq_len<span class="token punctuation">(</span>length<span class="token punctuation">(</span>data<span class="token operator">$</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        helpers<span class="token operator">$</span>input_list_item<span class="token punctuation">(</span>
            inputId <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
            option <span class="token operator">=</span> data<span class="token operator">$</span>options<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            value <span class="token operator">=</span> data<span class="token operator">$</span>values<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment"># bind to parent (you can add blank option here)</span>
    parent<span class="token operator">$</span>children <span class="token operator">&lt;-</span> children

    <span class="token comment"># return</span>
    return<span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Input values for the <code>input_list</code> function are passed down from the main <code>listbox</code> function.</p>
<span id="work-r-listbox" />
<h4>Main listbox function</h4>
<p>Now that the helper functions are defined, we can use them in the main function. To align the function with other Shiny input elements, I will use the following arguments.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">listbox<span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> title<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> options<span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre></div>
<p>By default, the <code>label</code> and <code>values</code> arguments are optional. If <code>values</code> is missing, then the input for <code>options</code> is used. Inputs for <code>options</code> and <code>values</code> should be a character array (i.e., <code>options = c(...)</code>).</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">listbox <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> title<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> options<span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment"># validate</span>
    stopifnot<span class="token punctuation">(</span>is.character<span class="token punctuation">(</span>inputId<span class="token punctuation">)</span><span class="token punctuation">)</span>
    stopifnot<span class="token punctuation">(</span>is.character<span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span>
    stopifnot<span class="token punctuation">(</span><span class="token operator">!</span>is.null<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># process options + values</span>
    data <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span>options <span class="token operator">=</span> options<span class="token punctuation">,</span> values <span class="token operator">=</span> options<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>is.null<span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span> data<span class="token operator">$</span>values <span class="token operator">&lt;-</span> values

    <span class="token comment"># set ID of text elements (for aria attributes)</span>
    titleId <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> <span class="token string">"__title"</span><span class="token punctuation">)</span>
    labelId <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span>inputId<span class="token punctuation">,</span> <span class="token string">"__label"</span><span class="token punctuation">)</span>

    <span class="token comment"># build component</span>
    el <span class="token operator">&lt;-</span> tags<span class="token operator">$</span>fieldset<span class="token punctuation">(</span>
        id <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
        class <span class="token operator">=</span> <span class="token string">"listbox-group hidden"</span><span class="token punctuation">,</span>
        `data<span class="token operator">-</span>group` <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
        `data<span class="token operator">-</span>value` <span class="token operator">=</span> <span class="token string">"NULL"</span><span class="token punctuation">,</span>

        <span class="token comment"># define title for the input group</span>
        tags<span class="token operator">$</span>legend<span class="token punctuation">(</span>
            id <span class="token operator">=</span> titleId<span class="token punctuation">,</span>
            class <span class="token operator">=</span> <span class="token string">"listbox-title"</span><span class="token punctuation">,</span>
            title
        <span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment"># generate menu toggle</span>
        helpers<span class="token operator">$</span>list_toggle<span class="token punctuation">(</span>
            inputId <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
            titleId <span class="token operator">=</span> titleId
        <span class="token punctuation">)</span><span class="token punctuation">,</span>

        <span class="token comment"># generate options list</span>
        helpers<span class="token operator">$</span>input_list<span class="token punctuation">(</span>
            inputId <span class="token operator">=</span> inputId<span class="token punctuation">,</span>
            data <span class="token operator">=</span> data<span class="token punctuation">,</span>
            titleId <span class="token operator">=</span> titleId
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># append label if present</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>is.null<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stopifnot<span class="token punctuation">(</span>is.character<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>
        el<span class="token operator">$</span>children <span class="token operator">&lt;-</span> tagList<span class="token punctuation">(</span>
            el<span class="token operator">$</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            tags<span class="token operator">$</span>span<span class="token punctuation">(</span>
                id <span class="token operator">=</span> labelId<span class="token punctuation">,</span>
                class <span class="token operator">=</span> <span class="token string">"listbox-label"</span><span class="token punctuation">,</span>
                lab
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            el<span class="token operator">$</span>children<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            el<span class="token operator">$</span>children<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># return</span>
    return<span class="token punctuation">(</span>el<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The label for the listbox widget is added only if a string is supplied. If present, the label is inserted after the title and before the button.</p>
<p>That is it for the R function. Load the CSS file into your app or add it to your existing CSS file. If you were to run the app at this point, it would return a simple button that does nothing when it is clicked. In the next section, we will create a custom input binding to define the behavior of the listbox widget.</p>
<span id="work-js" />
<h3>Creating the JavaScript input binding</h3>
<p>In this section, we will be working in <code>www/js/listbox.js</code>.</p>
<p>Shiny input bindings consist of a series of methods that define what happens when the listbox widget is rendered, when the user clicks the button or presses the down arrow key. There are several methods available (by Shiny.js) and are further detailed in RStudio's <a href="https://shiny.rstudio.com/articles/js-custom-input.html">Shiny input bindings guide</a>. The listbox widget will use the <code>initialize</code> (at render), <code>getValue</code> (how to set the value of widget), and <code>subscribe</code> (the events; buttons, key presses, etc.) methods. </p>
<p>The basic structure of the listbox input binding is in the following code block. New input bindings are created using <code>new Shiny.InputBinding()</code>. Use jQuery's <code>extend</code> to define the methods specific to the component (i.e., events, values to return, receive messages from R, etc.). Bindings must be registered with Shiny using <code>Shiny.inputBindings.register(...)</code>. Here is the basic structure for the listbox widget. I have already written the <code>find</code> and <code>unsubscribe</code> methods. <code>find</code> returns all instances of the listbox widget using the CSS class name (<code>listbox-group</code>; defined by the <code>listbox</code> function) and <code>unsubcribe</code> removes events created by the <code>subscribe</code> method.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// init binding</span>
<span class="token keyword">var</span> listbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shiny<span class="token punctuation">.</span>InputBinding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// define methods</span>
$<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>listbox<span class="token punctuation">,</span> <span class="token punctuation">{</span>

    <span class="token comment">// find: locate all instances of the listbox widget</span>
    <span class="token function-variable function">find</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">".listbox-group"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// on render</span>
    <span class="token function-variable function">initialize</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// returns the value of the listbox to be accessed in R via input$...</span>
    <span class="token function-variable function">getValue</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// events</span>
    <span class="token function-variable function">subscribe</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// off: remove events defined in subscribe</span>
    <span class="token function-variable function">unsubscribe</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">".listbox"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// register binding</span>
Shiny<span class="token punctuation">.</span>inputBindings<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>listbox<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<span id="work-js-initialize" />
<h4>initialize</h4>
<p>The purpose of the initialize method is to define what happens to the listbox widget as soon as it is rendered. By default, the widget sets the first option as the starting value. The value of the first option will be used to update the text display of the widget and made available in the Shiny server (via <code>input$...</code>). In this example, I set the value of the selected option to the custom data attribute <code>data-value</code> (found in the <code>&#x3C;fieldset></code> element). This step is not really relevant, but it could be useful if you would like to customize the appearance of the widget based on its current value.</p>
<p>There are also a few ARIA attributes that need to be set in this step. First, the list element (i.e., <code>&#x3C;ul></code>) needs to have the property <code>aria-activedescendant</code>. This attribute is updated when a new option is selected and the value is always the ID of the selected option. Second, the first option  and any selected option  must have the <code>aria-selected</code> attribute added. When this property is used, the value must be set to <code>true</code>. Remove this attribute entirely when an option is deselected rather than using <code>false</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">$<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>listbox<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token function-variable function">initialize</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// select list (ul) and first item in the list (li)</span>
        <span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"ul[role='listbox']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> first <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[role='option']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// update ARIA attributes</span>
        list<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"aria-activedescendant"</span><span class="token punctuation">,</span> first<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        first<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// add the value of the first item to the parent container (i.e., &lt;fieldset>)</span>
        <span class="token comment">// to a custom data attribute</span>
        <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-value"</span><span class="token punctuation">,</span> first<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// update displayed text</span>
        <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">".toggle-text"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-value"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<span id="work-js-getValue" />
<h4>getValue</h4>
<p>The <code>getValue</code> method will return the value of select option and make it available in the Shiny server. This method finds the option with the ARIA attribute <code>aria-selected</code> and extract its value.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">$<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>listbox<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token function-variable function">getValue</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[aria-selected='true']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<span id="work-js-subscribe" />
<h4>subscribe</h4>
<p>The subscribe method is used to define the behaviors of the listbox component in response to an event (e.g., mouse clicks, key presses, etc.). To ensure good web accessibility practices, the listbox widget must respond to several keyboard events. In The Web Accessibility Initiative (WAI) Authoring Practices <a href="https://www.w3.org/TR/wai-aria-practices/examples/listbox/listbox-collapsible.html">collapsible listbox widget</a> example, it is recommended to use the following events: enter, escape, up and down arrow, home, and end. These keys will handle the opening and closing of the listbox, navigation within the list of options, and the selection of new items. Since we need to attach these behaviors based on mouse and keyboard clicks, I will write a few helper functions that will open, close, and toggle the list of options, as well as a function that updates the component when a new option is selected.</p>
<p>The open and close functions are fairly straightforward. These functions either add or remove the CSS class <code>hidden</code> from the list, which toggles the CSS property <code>display: none</code>. Both functions will also update the ARIA attribute <code>aria-expanded</code> assigned to the listbox button. For visual purposes, the CSS class <code>rotated</code> will be added to the SVG icon. This will rotate the toggle icon (downward pointing chevron) by 180 degrees. The <code>closeMenu</code> and <code>openMenu</code> functions are wrapped in the <code>toggleMenu</code> function.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// define function that closes menu</span>
<span class="token keyword">function</span> <span class="token function">closeMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// find elements that will be modified on close</span>
    <span class="token keyword">var</span> menu <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"ul[role='listbox']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> toggle <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"button.listbox-toggle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// modify attributes</span>
    menu<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"hidden"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toggle<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"aria-expanded"</span><span class="token punctuation">,</span> <span class="token string">"false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toggle<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">".toggle-icon"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">"rotated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// define function that opens menu</span>
<span class="token keyword">function</span> <span class="token function">openMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// find elements that will be modified on open</span>
    <span class="token keyword">var</span> menu <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"ul[role='listbox']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> toggle <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"button.listbox-toggle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// modify attributes</span>
    menu<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">"hidden"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toggle<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"aria-expanded"</span><span class="token punctuation">,</span> <span class="token string">"false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toggle<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">".toggle-icon"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"rotated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// focus menu and scroll to selected element</span>
    menu<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// define function that toggles menu state</span>
<span class="token keyword">function</span> <span class="token function">toggleMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> menu <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"ul[role='listbox']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>menu<span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">"hidden"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">openMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">closeMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Next, we will need a function that updates the value of the listbox widget whenever an option is selected. This function will update the <code>aria-selected</code> attribute of the new option and update the displayed text with the new value. The function will also extract the ID of the new option and update the attribute <code>aria-activedescendant</code> assigned to the unordered list element. The last step runs a callback function  which is the <code>getValue</code> method  to update the value in the Shiny server.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// update component and selected item</span>
<span class="token keyword">function</span> <span class="token function">updateInput</span><span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// focus new element</span>
    <span class="token keyword">var</span> newElem <span class="token operator">=</span> elem<span class="token punctuation">;</span>
    newElem<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    newElem<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"focus"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// update menu attribute</span>
    <span class="token keyword">var</span> menu <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"ul[role='listbox']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    menu<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"aria-activedescendant"</span><span class="token punctuation">,</span> elem<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// update component value + display text</span>
    <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-value"</span><span class="token punctuation">,</span> elem<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-value"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">".toggle-text"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-value"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// run callback (i.e., getValue)</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span></code></pre></div>
<p>Using these functions, we can define the events for the listbox widget. There are three events: what happens when the button is clicked, when an option is clicked, and when a key is pressed. The first event, is attached to the listbox button and it will either open or close the listbox via <code>toggleMenu</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// event: when menu toggle is clicked</span>
<span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token string">"button.listbox-toggle"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">toggleMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The <code>keydown</code> event is a bit more involved than the click event as each key will results in a different action. Key codes can be accessed through <code>keyCode</code> data available from event (<code>e</code> for short) interface. The keys that are used in this binding are listed in the following table.</p>
<table>
<thead>
<tr>
<th align="left">key</th>
<th align="left">behavior</th>
<th align="left">code</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">up arrow</td>
<td align="left">focus previous option</td>
<td align="left">38</td>
</tr>
<tr>
<td align="left">down arrow</td>
<td align="left">focus next option</td>
<td align="left">40</td>
</tr>
<tr>
<td align="left">home</td>
<td align="left">focus first option</td>
<td align="left">36</td>
</tr>
<tr>
<td align="left">end</td>
<td align="left">focus last option</td>
<td align="left">35</td>
</tr>
<tr>
<td align="left">escape</td>
<td align="left">close menu</td>
<td align="left">27</td>
</tr>
<tr>
<td align="left">enter</td>
<td align="left">select current option</td>
<td align="left">13</td>
</tr>
</tbody>
</table>
<p>All key presses  except escape  will update the listbox's value automatically.</p>
<p>I will use switch statement to define the action for each key. The escape key is the simplest case as it closes the listbox (i.e., runs <code>closeMenu()</code>). When the enter key is pressed, the listbox is closed and the current option is selected. Behaviors for the up arrow, down arrow, home, and end are similar to enter, but these actions use jQuery's <code>prev</code>, <code>next</code>, <code>first</code> or <code>last</code> functions along with <code>length</code> to determine if there are any sibling elements. For example, if the first option is focused and the down arrow key is pressed, then the second option is selected. If the last option is focused and the down arrow is pressed, then nothing happens as there are no more options to select. </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// event: watch for keydowns</span>
<span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"keydown"</span><span class="token punctuation">,</span> <span class="token string">"ul[role='listbox']"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// on keydown: ArrowUp - code 38</span>
        <span class="token keyword">case</span> <span class="token number">38</span><span class="token operator">:</span>
            <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[aria-selected='true']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span><span class="token function">prev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> newElem <span class="token operator">=</span> current<span class="token punctuation">.</span><span class="token function">prev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                current<span class="token punctuation">.</span><span class="token function">removeAttr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">updateInput</span><span class="token punctuation">(</span>newElem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">// on keydown: ArrowDown - code 40</span>
        <span class="token keyword">case</span> <span class="token number">40</span><span class="token operator">:</span>
            <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[aria-selected='true']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> newElem <span class="token operator">=</span> current<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                current<span class="token punctuation">.</span><span class="token function">removeAttr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">updateInput</span><span class="token punctuation">(</span>newElem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">// on keydown: Home - code 36</span>
        <span class="token keyword">case</span> <span class="token number">36</span><span class="token operator">:</span>
            <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[aria-selected='true']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> first <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[role='option']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            current<span class="token punctuation">.</span><span class="token function">removeAttr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">updateInput</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">// on keydown: End - code 35</span>
        <span class="token keyword">case</span> <span class="token number">35</span><span class="token operator">:</span>
            <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[aria-selected='true']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[role='option']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            current<span class="token punctuation">.</span><span class="token function">removeAttr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">updateInput</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        
        <span class="token comment">// on keydown: Escape - code 27</span>
        <span class="token keyword">case</span> <span class="token number">27</span><span class="token operator">:</span>
            <span class="token function">closeMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">// on keydown: Enter - code 13</span>
        <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span>
            <span class="token keyword">var</span> selected <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">updateInput</span><span class="token punctuation">(</span>selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">closeMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>The last event is a click event that will be attached to each list item. This event will update the component using the value of the clicked item. Like the previous events, the ARIA attribute of the previously select option will be removed.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// on event: when option clicked</span>
<span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token string">"li[role='option']"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// make sure the &lt;li> element is selected</span>
    <span class="token comment">// this will handle situations when &lt;span> or &lt;icon> is</span>
    <span class="token comment">// clicked</span>
    <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"li[role='option'][aria-selected='true']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeAttr</span><span class="token punctuation">(</span><span class="token string">"aria-selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> elem <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">"li[role='option']"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">updateInput</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">closeMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>JQuery's <code>closest()</code> function is used to ignore the child elements (text and SVG icon) inside the selection option and return the list item.</p>
<p>The full input binding can be found on GitHub in the file <a href="https://github.com/davidruvolo51/shinyAppTutorials/blob/prod/shiny-listbox/www/js/listbox.js">listbox.js</a></p>
<span id="know" />
<h2>What do I need to know before I integrate this into my app?</h2>
<p>At the moment, the listbox component is fairly basic and the functionality of the widget could be improved. Initial accessibility checks were run using the <a href="https://wave.webaim.org">Web Accessibility Evaluation Tool (WAVE)</a>, but I would recommend further testing and review before using the listbox widget in any production application. </p>
<p>The code discussed in this post, provide a starting point for creating the listbox component. The functionality is fairly limited as only one option can be selected at a time. It is possible to add a multiple selection feature, but more key press events are required. It is likely that other input elements (checkbox groups, radio groups, etc.) are better options as some behaviors created for the listbox widget are already browser-ready. Semantic HTML elements are always better than custom components. Expanding this example to include multiple selections would take more thought and planning, and I wanted to keep this post relatively simple. </p>
<p>The listbox widget will also be included in <a href="https://github.com/davidruvolo51/accessibleshiny">accessibleshiny</a> package, so keep an eye out for a new version!</p>
<span id="run" />
<h2>How do I run the example?</h2>
<p>The full code for the demo is available on GitHub in the <a href="https://github.com/davidruvolo51/shinyAppTutorials/tree/prod/shiny-listbox">Listbox subfolder</a>. Alternatively, you can run the app directly from the R console using the following command.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">shiny<span class="token operator">::</span>runGitHub<span class="token punctuation">(</span>
    repo <span class="token operator">=</span> <span class="token string">"shinyAppTutorials"</span><span class="token punctuation">,</span>
    username <span class="token operator">=</span> <span class="token string">"davidruvolo51"</span><span class="token punctuation">,</span>
    subdir <span class="token operator">=</span> <span class="token string">"shiny-listbox"</span>
<span class="token punctuation">)</span></code></pre></div>
<span id="further-reading" />
<h2>Further reading</h2>
<p>For more information about the concepts and resources mentioned in this post, please visit the following links.</p>
<ul>
<li>Mozilla's <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/listbox_role">listbox role reference</a></li>
<li>On Key event codes: <a href="https://keycode.info">keycode.info</a></li>
<li>RStudio's <a href="https://shiny.rstudio.com/articles/building-inputs.html">Building Inputs Guide</a></li>
<li>RStudio's <a href="https://shiny.rstudio.com/articles/js-custom-input.html">How to create custom input bindings</a></li>
<li><a href="https://www.w3.org/TR/wai-aria-practices/">WAI-ARIA Authoring Practices</a></li>
<li>WAI-ARIA's <a href="https://www.w3.org/TR/wai-aria-practices/#Listbox">Listbox Widget</a></li>
<li>WAI-ARIA's <a href="https://www.w3.org/TR/wai-aria-practices/examples/listbox/listbox-collapsible.html">Collapsible Dropdown Listbox Example</a></li>
<li><a href="https://wave.webaim.org">Web Accessibility Evaluation Tool (WAVE)</a></li>
</ul></section><div class="article-footer"><p>Keywords</p><ul class="post-meta-tags article-tags" aria-label="post tags"><li><code class="tag tag-html">html</code></li><li><code class="tag tag-javascript">javascript</code></li></ul></div></article></div></div></main><footer class="footer"><h2>shinyTutorials</h2><ul class="menu footer-menu"><li class="menu-item"><a class="menu-link" href="/shinytutorials/privacy/">Privacy</a></li></ul><ul class="menu footer-menu"><li class="menu-item"><a class="menu-link" href="https://www.twitter.com/dcruvolo"><svg class="icon menu-link-icon" height="30" width="30" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg>@dcruvolo</a></li><li class="menu-item"><a class="menu-link" href="https://github.com/davidruvolo51/shinyAppTutorials"><svg class="icon menu-link-icon" height="30" width="30" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>shinyAppTutorials</a></li><li class="menu-item"><a class="menu-link" href="https://davidruvolo51.github.io/portfolio/"><svg class="icon" width="50" height="50" viewBox="0 0 50 40" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="user" transform="translate(11.280196, 6.000000)" stroke="currentColor" stroke-width="2" fill="currentColor"><path d="M27.1829506,38.463564 C27.1829506,31.1581236 23.1247009,23.3692614 18.2303544,21.0113097 C16.8720034,20.3568962 15.4135775,20 13.9041559,20 C12.4962651,20 11.1176019,20.3104979 9.81412773,20.8833092 C4.68481072,23.1373859 0.63453826,31.6314453 0.63453826,39.073266" id="body"></path><circle id="head" cx="13.7198041" cy="9" r="9"></circle></g></svg>My Portfolio</a></li></ul></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  window.excludeGAPaths=[/^(?:\/preview\/(?:(?!(?:\/|^)\.).)*?)$/,/^(?:\/do\-not\-track\/me\/too\/)$/];
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-76117337-11',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-76117337-11', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tutorials/listbox-widget/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-262a2394611464d0ed6a.js"],"app":["/app-af082cdb16f53309bbdd.js"],"component---src-components-tutorials-js":["/component---src-components-tutorials-js-0547688c067af1285829.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e90dfb9d534e7a568cc0.js"],"component---src-pages-about-js":["/component---src-pages-about-js-ea7f4459c93bb4b7df73.js"],"component---src-pages-gallery-index-js":["/component---src-pages-gallery-index-js-9381b15c4797798d57f6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-068dd64f5761140d392c.js"],"component---src-pages-privacy-js":["/component---src-pages-privacy-js-a7161cb28316b522bae8.js"],"component---src-pages-tutorials-index-js":["/component---src-pages-tutorials-index-js-cff00fc3ab70cb445794.js"]};/*]]>*/</script><script src="/shinytutorials/polyfill-262a2394611464d0ed6a.js" nomodule=""></script><script src="/shinytutorials/component---src-components-tutorials-js-0547688c067af1285829.js" async=""></script><script src="/shinytutorials/ec800322c0f71b5715d75b0073f476a066af1f45-b3608908e1193b5aeda5.js" async=""></script><script src="/shinytutorials/commons-e415ca64c704e109fced.js" async=""></script><script src="/shinytutorials/styles-407fe62976dc5310c43e.js" async=""></script><script src="/shinytutorials/app-af082cdb16f53309bbdd.js" async=""></script><script src="/shinytutorials/webpack-runtime-aa775fcdbf62117df72d.js" async=""></script></body></html>