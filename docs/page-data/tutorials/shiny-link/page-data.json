{"componentChunkName":"component---src-components-tutorials-js","path":"/tutorials/shiny-link/","result":{"data":{"markdownRemark":{"html":"<h2>Contents</h2>\n<ol>\n<li><a href=\"#about\">Why would I need this?</a></li>\n<li>\n<p><a href=\"#work\">How does this app work?</a></p>\n<ol>\n<li><a href=\"#work-ui-component\">Creating a link component</a></li>\n<li><a href=\"#work-js-binding\">Building a new shiny input binding</a></li>\n</ol>\n</li>\n<li><a href=\"#know\">What do I need to know before I integrate this into my app?</a></li>\n<li><a href=\"#run\">How do I run the demo?</a></li>\n</ol>\n<!-- endexcerpt -->\n<span id=\"about\" />\n<h2>Why would I need this?</h2>\n<p>In earlier tutorials, I provided a method for creating links to internal pages in Shiny applications. This is useful when using Shiny UI layouts —such as <code>navbar</code>, <code>tabPanel</code>, <code>tabsetPanel</code>, etc.— as internal links have auto-generated <code>href</code> attributes. The major drawback of the previous approach was that it rendered a link without the <code>href</code> attribute, which means that it isn't accessible. In addition, it was a bit tedious to define inline click events for each link. This can be difficult to manage for larger apps with nested layouts. To address these issues, it is easier to rewrite the earlier method using Shiny components and input bindings.</p>\n<p>In this post, we will create a small UI component that renders a link element and write an input binding that handles the application routing.</p>\n<blockquote>\n<p>This tutorial replaces the following Internal Links tutorials: <a href=\"../internal-links-a/\">part 1</a>, <a href=\"../internal-links-b/\">part 2</a>, and <a href=\"../internal-links-b/\">part-3</a>. I will leave those posts and example apps up for now, but they will be archived in the near future. (02 August 2020)</p>\n</blockquote>\n<span id=\"work\" />\n<h2>How does this app work?</h2>\n<p>In this post, I will cover the following steps.</p>\n<ol>\n<li>Creating a link component</li>\n<li>Building a new shiny input binding</li>\n</ol>\n<span id = \"work-ui-component\" />\n<h3>Creating a link component</h3>\n<p>First, we will develop a UI component that renders an anchor element. This component will take two arguments <code>to</code> and <code>label</code>. The argument <code>to</code> will receive value of the page (i.e., tab panel) that you would like to navigate to. Use the <code>label</code> argument to add a description of the link.</p>\n<p>In this example, I'm called the component <code>shinyLink</code>. If you want to render the value for label as HTML, then wrap label in the <code>HTML()</code> function (available via the Shiny package).</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">shinyLink <span class=\"token operator\">&lt;-</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    tags<span class=\"token operator\">$</span>a<span class=\"token punctuation\">(</span>\n        class <span class=\"token operator\">=</span> <span class=\"token string\">\"shiny__link\"</span><span class=\"token punctuation\">,</span>\n        href <span class=\"token operator\">=</span> to<span class=\"token punctuation\">,</span>\n        label\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Using this component, you can create links without have to add inline on-click events. Like the earlier examples, I strongly recommend using the <code>value</code> argument for each tab panel. By default, Shiny will substitute the value for <code>title</code> if <code>value</code> is NULL. The drawback is that if the title contains too many characters or other HTML elements, then it becomes difficult to find a matching link as this approach matches strings. Instead, set each tab's value using a short and concise ID that has no characters (exception for underscores or dashes).</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>shiny<span class=\"token punctuation\">)</span>\n\nui <span class=\"token operator\">&lt;-</span> navbarPage<span class=\"token punctuation\">(</span>\n    tabPanel<span class=\"token punctuation\">(</span>\n        title <span class=\"token operator\">=</span> <span class=\"token string\">\"Home\"</span><span class=\"token punctuation\">,</span>\n        value <span class=\"token operator\">=</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">,</span>\n        tags<span class=\"token operator\">$</span>h1<span class=\"token punctuation\">(</span><span class=\"token string\">\"Home Page\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tags<span class=\"token operator\">$</span>p<span class=\"token punctuation\">(</span>\n            <span class=\"token string\">\"You are currently on the page. Go to the\"</span><span class=\"token punctuation\">,</span>\n            shinyLink<span class=\"token punctuation\">(</span>to <span class=\"token operator\">=</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Page\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\".\"</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tabPanel<span class=\"token punctuation\">(</span>\n        title <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Visualizations, Tables, and Codebook\"</span><span class=\"token punctuation\">,</span>\n        value <span class=\"token operator\">=</span> <span class=\"token string\">\"data\"</span><span class=\"token punctuation\">,</span>\n        tags<span class=\"token operator\">$</span>h1<span class=\"token punctuation\">(</span><span class=\"token string\">\"Data\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tags<span class=\"token operator\">$</span>p<span class=\"token punctuation\">(</span>\n            <span class=\"token string\">\"You are currently on the data page. Go back to the\"</span><span class=\"token punctuation\">,</span>\n            shinyLink<span class=\"token punctuation\">(</span>to <span class=\"token operator\">=</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">\"Home Page\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\".\"</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<span id = \"work-js-binding\" />\n<h3>Building a new shiny input binding</h3>\n<p>Next, we will create a new input binding that defines how the <code>shinyLink</code> component behaves. A shiny input binding is used to link a component with R. In this post, I will cover the basics for the <code>shinyLink</code> component. See RStudio's <a href=\"https://shiny.rstudio.com/articles/js-custom-input.html\">How to Create Shiny Input Bindings guides</a> for more information.</p>\n<p>New input bindings are created using <code>new Shiny.InputBinding()</code>. Use jQuery's <code>extend</code> to define the methods specific to the component (i.e., events, values to return, receive messages from R, etc.). To use our input binding in Shiny, it must be registered via <code>Shiny.inputBindings.register(...)</code>. Here is the basic structure for the <code>shinyLink</code> component.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// init binding</span>\n<span class=\"token keyword\">var</span> shinyLink <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Shiny<span class=\"token punctuation\">.</span>InputBinding</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// define methods</span>\n$<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>shinyLink<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// register</span>\nShiny<span class=\"token punctuation\">.</span>inputBindings<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>shinyLink<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now, let's define the methods. There are many methods to choose from. In this example, we will use the following.</p>\n<ol>\n<li><code>find</code>: used to find all instances of the <code>shinyLink</code> component (required).</li>\n<li><code>initialize</code>: this method runs when the component is rendered. For the <code>shinyLink</code> component, the initialize method defines what happens when the link is clicked. When a <code>shinyLink</code> is clicked, the click event will find the target link (i.e., tab that you want to navigate to) and activate it. </li>\n</ol>\n<p>In shiny apps, there may be situations when the destination panel is nested inside another tab panel. In the previous tutorials, the solution was to call the function twice as the parent tab needs to be activated before the target tab can be activated. The binding for the link component eliminates the need to do this as it will examine the parent navigation list (i.e., <code>&#x3C;ul></code>) to determine if the destination is a page or a tab within a page. If the destination is the latter, then the input binding will find and activate the parent page before activating the destination tab.</p>\n<p>Here is the complete input binding for the link component.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// init binding</span>\n<span class=\"token keyword\">var</span> shinyLink <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Shiny<span class=\"token punctuation\">.</span>InputBinding</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// define methods</span>\n$<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>shinyLink<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">find</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">scope</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>scope<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a.shiny__link\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">initialize</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            \n            <span class=\"token comment\">// extract destination and find matching link</span>\n            <span class=\"token keyword\">var</span> to <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"href\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> target <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">a[data-value=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>to<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">// does the link exist?</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n                <span class=\"token comment\">// if the parent ul of the matching link has the class `.navbar-nav`,</span>\n                <span class=\"token comment\">// then click the link. Links with these classes are</span>\n                <span class=\"token comment\">// located in the navbar element.</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"navbar-nav\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    window<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                \n                <span class=\"token comment\">// if the parent ul of the matching link has the class `.nav-tabs`,</span>\n                <span class=\"token comment\">// then this indicates that the link is part of of a tabSetPanel</span>\n                <span class=\"token comment\">// inside a tabPanel. This means, that parent tabPanel must</span>\n                <span class=\"token comment\">// be found and activated before activating the tabPanel.</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nav-tabs\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    \n                    <span class=\"token comment\">// find the nearest .tab-pane and extract `data-value`</span>\n                    <span class=\"token keyword\">var</span> val <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">closest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div.tab-pane\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">var</span> parentLink <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">a[data-toggle=\"tab\"][data-value=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>val<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                    <span class=\"token comment\">// activate parent (if not already active)</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>parentLink<span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        parentLink<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n\n                    <span class=\"token comment\">// activate destination tab</span>\n                    target<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    window<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token punctuation\">}</span>\n                \n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No matching link found. Is the destination correct?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// register</span>\nShiny<span class=\"token punctuation\">.</span>inputBindings<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>shinyLink<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<span id=\"know\" />\n<h2>What do I need to know before I integrate this into my app?</h2>\n<p>The click event is limited to the <code>tabPanel</code> and <code>tabsetPanel</code> relationship. If you have tabs that are nested beyond this hierarchy, then restructure the initialize method as a recursive function.</p>\n<span id=\"run\" />\n<h2>How do I run the example?</h2>\n<p>The full code for the demo is available on GitHub in the <a href=\"https://github.com/davidruvolo51/shinyAppTutorials/tree/prod/shiny-links\">Shiny Links subfolder</a>. Alternatively, you can run the app directly from the R console using the following command.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">shiny<span class=\"token operator\">::</span>runGitHub<span class=\"token punctuation\">(</span>\n    repo <span class=\"token operator\">=</span> <span class=\"token string\">\"shinyAppTutorials\"</span><span class=\"token punctuation\">,</span>\n    username <span class=\"token operator\">=</span> <span class=\"token string\">\"davidruvolo51\"</span><span class=\"token punctuation\">,</span>\n    subdir <span class=\"token operator\">=</span> <span class=\"token string\">\"shiny-links\"</span>\n<span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"Creating Internal Links","subtitle":"Defining Application Navigation","abstract":"The app shiny-links replaces the previous examples on creating links to tabs and panels in shiny apps. I rewrote the previous method using a functional component and a Shiny Input Binding.","date":"2020-08-02","updated":"2020-08-02","keywords":["javascript"]},"fields":{"readingTime":{"minutes":5.715}}}},"pageContext":{"slug":"/tutorials/shiny-link/"}},"staticQueryHashes":["63159454"]}